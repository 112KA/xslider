!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).XSlider=e()}(this,(function(){"use strict";var t={extend:function(t,e){var n={};return Object.assign(n,t),Object.entries(e).forEach((function(t){n[t[0]]=t[1]})),n},delegate:function(t,e){Object.entries(e).forEach((function(e){t[e[0]]=e[1]}))},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},getQuery:function(t,e){if(void 0===e&&(e=!0),!this._query||!e){this._query={};for(var n=window.location.search.substring(1).split("&"),o=0;o<n.length;o++){var i=n[o].split("="),r=decodeURIComponent(i[0]),s=decodeURIComponent(i[1]);this._query[r]=s}}return this._query[t]}},e=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.set(t,e)},n={x:{configurable:!0},y:{configurable:!0}};e.prototype.set=function(t,e){this.data=[t,e]},n.x.get=function(){return this.data[0]},n.y.get=function(){return this.data[1]},n.x.set=function(t){this.data[0]=t},n.y.set=function(t){this.data[1]=t},Object.defineProperties(e.prototype,n);var o=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.set(t,e,n)},i={x:{configurable:!0},y:{configurable:!0},z:{configurable:!0}};o.prototype.set=function(t,e,n){this.data=[t,e,n]},i.x.get=function(){return this.data[0]},i.y.get=function(){return this.data[1]},i.z.get=function(){return this.data[2]},i.x.set=function(t){this.data[0]=t},i.y.set=function(t){this.data[1]=t},i.z.set=function(t){this.data[2]=t},Object.defineProperties(o.prototype,i);var r=function(t,e,n,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=0),this.set(t,e,n,o)},s={width:{configurable:!0},height:{configurable:!0},x:{configurable:!0},y:{configurable:!0},z:{configurable:!0},w:{configurable:!0}};r.prototype.set=function(t,e,n,o){this.data=[t,e,n,o]},s.width.set=function(t){this.data[2]=t},s.width.get=function(){return this.data[2]},s.height.set=function(t){this.data[3]=t},s.height.get=function(){return this.data[3]},s.x.get=function(){return this.data[0]},s.y.get=function(){return this.data[1]},s.z.get=function(){return this.data[2]},s.w.get=function(){return this.data[3]},s.x.set=function(t){this.data[0]=t},s.y.set=function(t){this.data[1]=t},s.z.set=function(t){this.data[2]=t},s.w.set=function(t){this.data[3]=t},r.prototype.equals=function(t){return this.x===t.x&&this.y==t.y&&this.z==t.z&&this.w==t.w},Object.defineProperties(r.prototype,s);var a={vertexShader:"\nattribute vec2 position;\n\nvoid main(void) {\n\tgl_Position = vec4(position, 0.0, 1.0);\n}\n",fragmentShader:"\nprecision highp float;\n\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform float progress;\nuniform vec2 resolution;\nuniform vec2 gradient;\n\nvoid main(void) {\n\tvec2 uv = gl_FragCoord.xy /resolution.xy;\n\tvec4 color0 = texture2D(texture0, uv);\n\tvec4 color1 = texture2D(texture1, uv);\n\tfloat v = smoothstep(0.0, 1.0, progress * (1.0+gradient.x+gradient.y) - ((1.0-uv.x)*gradient.x+uv.y*gradient.y));\n\tgl_FragColor = mix(color0, color1, v);\n}\n",uniforms:{gradient:{value:new e(1,1)}},extend:function(e){return t.extend(this,e)}},c={selector:"#xslider",initialSlideIndex:0,autoplay:!1,loop:!0,touchMove:{throwable:!0},renderer:void 0,debug:!1,easing:.15,transition:a,get:function(t,e){return e?this[e]?this[e][t]:void 0:this[t]},Debug:{DISPLAY:{DOM:"DEBUG_DISPLAY_DOM",SVG:"DEBUG_DISPLAY_SVG",IMG:"DEBUG_DISPLAY_IMG"}}},u=function(){this._listeners={},this._properties={}},p={listeners:{configurable:!0}};p.listeners.get=function(){return this._listeners},u.prototype.get=function(t){return this._properties[t]},u.prototype.set=function(t){if(t)for(var e in t)if(void 0===this._properties[e]&&void 0!==t[e]||this._properties[e]!==t[e]){var n=this._properties[e];this._properties[e]=t[e],this.dispatch(e,{type:e,value:this._properties[e],value0:n})}},u.prototype.dispatch=function(t,e){this._listeners.hasOwnProperty(t)&&this._listeners[t].forEach((function(n){var o=e||{type:t};n.listener(o)}))},u.prototype.on=function(t,e){return this.off(t,e),this._listeners.hasOwnProperty(t)||(this._listeners[t]=[]),this._listeners[t].push({type:t,listener:e}),this},u.prototype.off=function(t,e){var n=this;if(t)e?this._listeners.hasOwnProperty(t)&&(this._listeners[t].some((function(o,i){o.listener==e&&n._listeners[t].splice(i,1)})),0==this._listeners[t].length&&delete this._listeners[t]):delete this._listeners[t];else for(var o in this._listeners)delete this._listeners[o];return this},Object.defineProperties(u.prototype,p);var h=function(t){function e(){t.call(this),console.info("xslider ver.","1.1.0")}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={support:{configurable:!0}};return n.support.get=function(){return e.support},Object.defineProperties(e.prototype,n),e}(u);h.support={touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,pointer:window.navigator.pointerEnabled,MSPointer:window.navigator.msPointerEnabled};var l=new h,d=[];l.support.touch?d.push("touchstart","touchmove","touchend"):l.support.pointer?d.push("pointerdown","pointermove","pointerup"):l.support.MSPointer?d.push("MSPointerDown","MSPointerMove","MSPointerUp"):d.push("mousedown","mousemove","mouseup");var f={START:d[0],MOVE:d[1],END:d[2]},v=function(t){function e(){t.call(this),this._defineHandlers(),this.on("target",this._on.changeTarget)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._defineHandlers=function(){var t=this;this._on={bubble:function(e){t.dispatch(e.type,e)},changeTarget:function(e){if(e.value0)for(var n in t._listeners)t._autoRemoveListener(e.value0,n);t.off()},touch:function(e){if(l.support.touch){var n=e.touches[0];n?(e.clientX=n.clientX,e.clientY=n.clientY):(e.clientX=t.clientX0,e.clientY=t.clientY0)}t.clientX0||(t.clientX0=e.clientX,t.clientY0=e.clientY),e.clientX0=t.clientX0,e.clientY0=t.clientY0,t.clientX0=e.clientX,t.clientY0=e.clientY,t.dispatch(e.type,e)},touchStart:function(e){t.clientX0=t.clientY0=void 0}}},e.prototype.dispose=function(){this.off()},e.prototype.on=function(e,n,o){t.prototype.on.call(this,e,n,o);var i=this.get("target");return this._autoAddListener(i,e),this},e.prototype.off=function(e,n){t.prototype.off.call(this,e,n);var o=this.get("target");return this._autoRemoveListener(o,e),this},e.prototype._autoAddListener=function(t,e){if(t&&1==this._listeners[e].length){switch(e){case f.START:case f.MOVE:case f.END:t.addEventListener(e,this._on.touch);break;case"click":t.addEventListener(e,this._on.bubble)}e==f.MOVE&&t.addEventListener(f.START,this._on.touchStart)}},e.prototype._autoRemoveListener=function(t,e){if(t&&(!this._listeners[e]||0==this._listeners[e].length)){switch(e){case f.START:case f.MOVE:case f.END:t.removeEventListener(e,this._on.touch);break;case"click":t.removeEventListener(e,this._on.bubble)}e==f.MOVE&&t.removeEventListener(f.START,this._on.touchStart)}},e}(u),g=function(t){function e(){t.call(this),this.fps=30,this._defineFunctions()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={fps:{configurable:!0},time:{configurable:!0}};return e.prototype._defineFunctions=function(){for(var t=this,e=["ms","moz","webkit","o"],n=e.length;--n>-1&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];this._tickHandler=function(){t._requestId=window.requestAnimationFrame(t._tickHandler),t._lastMs=t.time;var e=t._lastMs-t._nextMs;if(e>=0){var n=t._nextMs;t._nextMs+=e+(e>=t._gap?1:t._gap-e),t.dispatch("tick",{type:"tick",time:t._lastMs-t._startMs,dt:t._nextMs-n})}}},n.fps.get=function(){return this._fps},n.fps.set=function(t){this._fps=t,this._gap=1/(t||60)*1e3},n.time.get=function(){return Date.now()||(new Date).getTime()},e.prototype.start=function(){this._startMs=this.time,this._nextMs=this._startMs+this._gap,this._requestId=window.requestAnimationFrame(this._tickHandler)},e.prototype.stop=function(){window.cancelAnimationFrame(this._requestId)},Object.defineProperties(e.prototype,n),e}(u),m=new(function(t){function e(){t.call(this),this.ticker=new g,this.set({target:window})}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={width:{configurable:!0},height:{configurable:!0}};return e.prototype.ready=function(){return new Promise((function(t,e){var n=function(){document.removeEventListener("DOMContentLoaded",n),window.removeEventListener("load",n),t()};"complete"===document.readyState?t():(document.addEventListener("DOMContentLoaded",n),window.addEventListener("load",n))}))},n.width.get=function(){return window.innerWidth||document.documentElement.clientWidth||0},n.height.get=function(){return window.innerHeight||document.documentElement.clientHeight||0},e.prototype._autoAddListener=function(e,n){if(e&&(t.prototype._autoAddListener.call(this,e,n),1==this._listeners[n].length))switch(n){case"tick":this.ticker.on(n,this._on.bubble),this.ticker.start();break;case"resize":e.addEventListener(n,this._on.bubble)}},e.prototype._autoRemoveListener=function(e,n){if(e&&(t.prototype._autoRemoveListener.call(this,e,n),!this._listeners[n]||0==this._listeners[n].length))switch(n){case"tick":this.ticker.off(n,this._on.bubble),this.ticker.stop();break;case"resize":e.removeEventListener(n,this._on.bubble)}},Object.defineProperties(e.prototype,n),e}(v)),_=function(t){function e(){t.call(this),this._defineHandlers()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={width:{configurable:!0},height:{configurable:!0}};return e.prototype._defineHandlers=function(){var t=this;this._onResize=function(e){t._width==t.width&&t._height==t.height||(t._width=t.width,t._height=t.height,t.dispatch("resize",{type:"resize",width:t._width,height:t._height}))}},n.width.get=function(){return this.container.clientWidth},n.height.get=function(){return this.container.clientHeight},e.prototype.setup=function(t){this.container=document.querySelector(t),this.container.classList.add("xslider-container"),this.view=this.container.querySelector(".xslider-view"),this.slides=this.view.querySelectorAll(".xslider-slide"),this.pager=this.container.querySelector(".xslider-pager"),this.prev=this.container.querySelector(".xslider-prev"),this.next=this.container.querySelector(".xslider-next"),m.on("resize",this._onResize)},e.prototype.dispose=function(){this._width=this._height=void 0,m.off("resize",this._onResize),this.container.classList.remove("xslider-container","xslider-debug")},Object.defineProperties(e.prototype,n),e}(u),y=function(){var t="application/font-woff",e="image/jpeg";this.mimes={woff:t,woff2:t,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:e,jpeg:e,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}};y.prototype.loadImage=function(t,e){return new Promise((function(n,o){var i=function(){t.complete?n():setTimeout(i,10)};t.src=e,i()}))},y.prototype.get=function(t,e){return new Promise((function(n,o){var i=new XMLHttpRequest;i.onreadystatechange=function(){switch(i.readyState){case 4:200==i.status||304==i.status?n(i.response):o()}},i.ontimeout=function(){o()},i.responseType=e,i.timeout=3e4,i.open("GET",t,!0),i.send(null)}))},y.prototype.getDataURI=function(t){var e=this,n=this.parseExtension(t);return this.get(t,"blob").then((function(t){return e.readBlob.bind(e)(t,n)}))},y.prototype.parseExtension=function(t){var e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:null},y.prototype.getMimeType=function(t){},y.prototype.readBlob=function(t,e){var n=new FileReader,o=e?this.mimes[e]:null;return new Promise((function(e,i){n.onloadend=function(){var t=n.result;o&&(t=t.split(",")[1],t="data:"+o+";base64,"+t),e(t)},n.readAsDataURL(t)}))};var x=new y,b=function(){};b.prototype.copyStyle=function(t,e,n){var o={};if(n&&n.length>0)for(var i=0;i<n.length;i++){var r=n[i];o[r]=e.getPropertyValue(r)}if(t.cssText)e.cssText=t.cssText;else for(var s=0;s<t.length;s++){var a=t[s];e.setProperty(a,t.getPropertyValue(a),t.getPropertyPriority(a))}Object.getOwnPropertyNames(o).forEach((function(t){e.setProperty(t,o[t])}))},b.prototype.cloneNode=function(t){var e=this,n=t.cloneNode(!1);return new Promise((function(o,i){if(t instanceof Element)if(e.copyStyle(window.getComputedStyle(t),n.style),t.hasChildNodes()){var r=t.childNodes,s=[];r.forEach((function(t,o,i){var r=e.cloneNode(t).then((function(t){e.insertChildAtIndex(n,t,o)}));s.push(r)})),Promise.all(s).then((function(){o(n)}))}else o(n);else o(n)}))},b.prototype.insertChildAtIndex=function(t,e,n){n||(n=0),n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n])},b.prototype.cloneStyle=function(t,e,n){var o=this;return t instanceof Element?(this.copyStyle(window.getComputedStyle(t),e.style,n),t.hasChildNodes()?void t.childNodes.forEach((function(t,i,r){o.cloneStyle(t,e.childNodes[i],n)})):e):e};var w=new b,E={URL_REGEX:/url\(['"]?([^'"]+?)['"]?\)/g,resolveFonts:function(){var t=this;return new Promise((function(e,n){if(t.inlinedFontString)e();else{var o=t.readFontRules().map((function(t){return t.cssText}));t.inlineFonts(o).then((function(n){t.inlinedFontString=n.join(" "),e()}))}}))},readFontRules:function(){for(var t=[],e=document.styleSheets,n=0;n<e.length;n++){var o=e[n];if(o.cssRules)for(var i=0;i<o.cssRules.length;i++){var r=o.cssRules[i];r.type===CSSRule.FONT_FACE_RULE&&t.push(r)}}return t},inlineFonts:function(t){var e=this,n=t.map((function(t){return e._inline(t)}));return Promise.all(n)},inlineNode:function(t){return w.cloneNode(t).then(this.inlineImage.bind(this))},_inline:function(t){var e=this.searchUrls(t),n=[];return e.map((function(e){var o=x.getDataURI(e).then((function(n){t=t.replace(e,n)}));n.push(o)})),Promise.all(n).then((function(){return t}))},searchUrls:function(t){for(var e,n=this,o=[];null!==(e=this.URL_REGEX.exec(t));)o.push(e[1]);return o.filter((function(t){return n.isDataURI(t)}))},inlineImage:function(t){var e=this;return new Promise((function(n,o){Promise.resolve(t).then(e.inlineImageElement.bind(e)).then(e.inlineBackgroundImage.bind(e)).then((function(){if(t.hasChildNodes()){var o=t.childNodes,i=[];o.forEach((function(t,n,o){var r=e.inlineImage(t);i.push(r)})),Promise.all(i).then((function(){n(t)}))}else n(t)}))}))},inlineImageElement:function(t){return t instanceof HTMLImageElement?this.isDataURI(t.src)?t:new Promise((function(e,n){x.getDataURI(t.src).then((function(o){t.onload=function(){e(t)},t.onerror=n,t.src=o}))})):t},inlineBackgroundImage:function(t){if(!(t instanceof Element))return t;var e=t.style.getPropertyValue("background");return e?this._inline(e).then((function(e){return t.style.setProperty("background",e),t})):t},isDataURI:function(t){return-1===t.search(/^(data:)/)}},T={parser:new DOMParser,convert:function(t,e,n){t.setAttribute("xmlns","http://www.w3.org/1999/xhtml");var o='<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+n+'">\n\t\t<foreignObject x="0" y="0" width="100%" height="100%">\n\t\t</foreignObject>\n\t\t</svg>',i=this.parser.parseFromString(o,"text/xml"),r=document.createElement("style");return r.appendChild(document.createTextNode(E.inlinedFontString)),t.appendChild(r),i.getElementsByTagName("foreignObject")[0].appendChild(t),i}},S=function(t,e){this.element=t,this.debug=e,this.canvas=document.createElement("canvas"),this.image=new Image,this.layer={gl:t.querySelector(".xslider-layer-gl"),ui:t.querySelector(".xslider-layer-ui")},this.debug==c.Debug.DISPLAY.IMG&&this.element.insertBefore(this.image,this.layer.gl),this.inlinedNode=void 0,this.needsResize=!1};S.prototype.dispose=function(){this.layer.gl&&this.layer.gl.classList.remove("xslider-capture")},S.prototype.ready=function(){var t=this;return new Promise((function(e,n){t.inlinedNode?e():t.layer.gl?E.inlineNode(t.layer.gl).then((function(n){t.inlinedNode=n,e()})):e()}))},S.prototype.loadSvg=function(t,e){this.svg=T.convert(this.inlinedNode,t,e);var n=(new XMLSerializer).serializeToString(this.svg),o="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(n);if(this.debug==c.Debug.DISPLAY.SVG)if(void 0===this._svg0)this._svg0=this.element.insertBefore(this.svg.childNodes[0],this.layer.gl);else{var i=this.svg.childNodes[0];this.element.replaceChild(i,this._svg0),this._svg0=i}return x.loadImage(this.image,o)},S.prototype.resize=function(t,e){var n=this;return new Promise((function(o,i){n.needsResize?(n.needsResize=!1,n.canvas.width=t,n.canvas.height=e,n.layer.gl?(n.layer.gl.classList.add("xslider-capture"),w.cloneStyle(n.layer.gl,n.inlinedNode,S.EXCLUDES),n.layer.gl.classList.remove("xslider-capture"),n.loadSvg(t,e).then((function(){var i=n.canvas.getContext("2d");i.clearRect(0,0,t,e),i.drawImage(n.image,0,0,t,e),o()}))):o()):o()}))},S.EXCLUDES=["background","left","right","width","height"];var C=function(t){function e(){t.call(this),this._defineHandlers(),this.width=this.height=-1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._defineHandlers=function(){var t=this;this._onChangeSlide=function(e){var n=!1;switch(e.type){case"slide0":t.updateSlide(0),n=void 0!==e.value0;break;case"slide1":t.updateSlide(1),n=void 0!==e.value0&&e.value0!==t.get("slide0")}n&&e.value0.element.classList.remove("xslider-slide-active")}},e.prototype.ready=function(t){var e=this,n=t.data.list[t.i0],o=void 0,i=[n.ready()];return void 0!==t.i1&&(o=t.data.list[t.i1],i.push(o.ready())),Promise.all(i).then((function(){e.set({slide0:n,slide1:o})}))},e.prototype.setup=function(t){this.mesh=t,this.mesh&&(this.uniforms=this.mesh.material.uniforms),this.on("slide0",this._onChangeSlide),this.on("slide1",this._onChangeSlide)},e.prototype.dispose=function(){this.off("slide0",this._onChangeSlide),this.off("slide1",this._onChangeSlide);var t=this.get("slide0"),e=this.get("slide1");t.element.classList.remove("xslider-slide-active"),e&&e.element.classList.remove("xslider-slide-active")},e.prototype.resize=function(t,e){return this.width=t,this.height=e,this.mesh&&this.uniforms.resolution.value.set(t,e),Promise.all([this.updateSlide(0),this.updateSlide(1)])},e.prototype.updateSlide=function(t){var e=this;if(-1!=this.width||-1!=this.height){var n=this.get("slide"+t);return new Promise((function(o,i){if(!n){if(e.uniforms){var r=e.uniforms["texture"+t].value;r.image=void 0,r.needsUpdate=!0}o()}n.element.classList.add("xslider-slide-active"),n.resize(e.width,e.height).then((function(){if(e.uniforms){var i=e.uniforms["texture"+t].value;i.image=n.canvas,i.needsUpdate=!0}o()}))}))}},e}(u),O=function(t){function e(){t.call(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setup=function(t,e){this.data=t,this.container=e},e.prototype.dispose=function(){},e.prototype.render=function(t){},e.prototype.resize=function(t,e){this.width=t,this.height=e},e}(u),D=function(t){function e(){t.call(this),this.canvas=document.createElement("canvas"),this._defineHandlers()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._defineHandlers=function(){},e.prototype.setup=function(e,n){t.prototype.setup.call(this,e,n),e.dom.container.insertBefore(this.canvas,e.dom.view)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.container.off("updateTexture",this._onUpdateTexture),this.data.dom.container.removeChild(this.canvas)},e.prototype.render=function(e){t.prototype.render.call(this,e),this.container.uniforms.progress.value=e.progress,this.container.uniforms.time&&(this.container.uniforms.time.value=this.data.time)},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n)},e}(O),P=function(e){function n(){e.call(this),this._defineHandlers()}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype._defineHandlers=function(){var t=this;this.dx=0,this._onTick=function(e){console.log("e: ",e),t.dx=30*Math.sin(e.time/1e3);var n=t.data.list[0];n&&(n.layer.ui.style.webkitTransform="translate("+t.dx+"px, 0)")}},n.prototype.setup=function(t,n){e.prototype.setup.call(this,t,n)},n.prototype.dispose=function(){e.prototype.dispose.call(this)},n.prototype.render=function(n){e.prototype.render.call(this,n);var o=this.data.list[n.i0],i=this.data.list[n.i1],r=1-t.clamp(n.progress,0,.5)/.5,s=-n.progress*this.width;this.updateSlide(o,r,s),o!=i&&(r=t.clamp(n.progress-.5,0,.5)/.5,s=(1-n.progress)*this.width,this.updateSlide(i,r,s))},n.prototype.resize=function(t,n){e.prototype.resize.call(this,t,n)},n.prototype.updateSlide=function(t,e,n){t&&t.layer.ui&&(t.layer.ui.style.webkitTransform="translate("+n+"px, 0) scale(1)")},n}(O),R=function(t){function e(){t.call(this),this.needsUpdate=!0,this.location=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(u),A="BYTE",M="UNSIGNED_BYTE",k="SHORT",z="UNSIGNED_SHORT",N="INT",I="UNSIGNED_INT",U="FLOAT",F=function(t,e){switch(t){case A:return new Int8Array(e);case M:return new Uint8Array(e);case k:return new Int16Array(e);case z:return new Uint16Array(e);case N:return new Int32Array(e);case I:return new Uint32Array(e);case U:return new Float32Array(e)}},L=function(t){function e(e,n,o){t.call(this),this.format=e,this.bufferType=n,this.usage=o,this.data=F(this.format,1)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){this.position=0,this.limit=0,this.needsUpdate=!0},e.prototype.allocate=function(t){this.data.length<t&&this.extend(t),this.clear()},e.prototype.get=function(t,e){return void 0===e&&(e=1),this.data.subarray(t,e)},e.prototype.put=function(t){t instanceof Array||t instanceof Float32Array?(this.data.set(t,this.position),this.position+=t.length):(this.data[this.position]=t,this.position+=1),this.limit=this.position,this.needsUpdate=!0},e.prototype.update=function(t,e){t instanceof Array||t instanceof Float32Array?this.data.set(t,e):this.data[e]=t,this.needsUpdate=!0},e.prototype.extend=function(t){for(var e=this.data,n=e.length;n<t;)n*=2;this.data=F(this.format,n),this.data.set(e)},e}(R);L.Usage={Static:"STATIC_DRAW",Dynamic:"DYNAMIC_DRAW",Stream:"STREAM_DRAW"},L.Type={Interleaved:"Interleaved",Index:"Index"};var j=function(t){function e(e){t.call(this,z,t.Type.Index,t.Usage.Static),this.drawMode=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(L);j.DrawMode={Triangles:"TRIANGLES"};var B=function(t){function e(e){t.call(this),this.image=void 0,e&&this.setup(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setup=function(t){var e=this;return this.image||(this.image=new Image),new Promise((function(n,o){e.image.src!=t?(e.needsUpdate=!1,e.image.src=t,e.image.onload=function(){e.needsUpdate=!0,n()}):n()}))},e}(R),V=function(){this.identity()};V.prototype.identity=function(){this.data=[1,0,0,0,1,0,0,0,1]},V.prototype.copy=function(t){for(var e=0;e<this.data.length;e++)t.data[e]=this.data.length},V.prototype.translate=function(){},V.prototype.rotate=function(){},V.prototype.update=function(t,e,n,o,i){var r=Math.sin(n),s=Math.cos(n),a=this.data;a[0]=s*o,a[1]=r*o,a[3]=-r*i,a[4]=s*i,a[6]=t,a[7]=e};var X=function(){this.identity()};X.prototype.identity=function(){this.data=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},X.prototype.copy=function(t){for(var e=0;e<this.data.length;e++)t.data[e]=this.data.length},X.prototype.perspective=function(t,e,n,o){var i=2*n;t=t*Math.PI/180;var r=1/(n-o),s=Math.tan(t/2)*n,a=-s,c=e*a,u=-c,p=this.data;p[0]=i/(u-c),p[5]=i/(s-a),p[10]=(o+n)*r,p[11]=-1,p[14]=i*o*r,p[15]=0},X.prototype.update=function(t,e,n,o,i,r,s,a,c){var u=Math.sin(o),p=Math.cos(o),h=Math.sin(i),l=Math.cos(i),d=Math.sin(r),f=Math.cos(r),v=h*u,g=h*p,m=this.data;m[0]=f*l*s,m[1]=d*l*s,m[2]=-h*s,m[4]=(f*v-d*p)*a,m[5]=(d*v+f*p)*a,m[6]=l*u*a,m[8]=(f*g+d*u)*c,m[9]=(d*g-f*u)*c,m[10]=l*p*c,m[12]=t,m[13]=e,m[14]=n};var H="Int",G="Float",q="Vector2",Y="Vector3",W="Vector4",K="Matrix3",Q="Matrix4",Z=function(t){function e(e,n,o){t.call(this),this.name=e,this.format=n,this.shaderVarFormat=o,this.offset=0,this.size=function(t){switch(t){case H:case G:return 1;case q:return 2;case Y:return 3;case W:return 4;case K:return 9;case Q:return 16;default:return 0}}(o)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(R),$=function(t){function n(n,i,s){var a,c;if(void 0===s&&(s=-1),i)switch(a=U,i.value.constructor){case B:a=N,c=H;break;case V:c=K;break;case X:c=Q;break;case e:c=q;break;case o:c=Y;break;case r:c=W;break;default:c=G}t.call(this,n,a,c),this.valueObject=i,this.textureUnit=s}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n}(Z);$.Binding={Projection:"projectionMatrix",ModelView:"modelViewMatrix"};var J=function(t){function e(e){t.call(this),this.type=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.updateSource=function(t){this.source=t},e}(R);J.VERTEX="VERTEX_SHADER",J.FRAGMENT="FRAGMENT_SHADER";var tt=function(t){function e(){t.call(this),this.vertex=new J(J.VERTEX),this.fragment=new J(J.FRAGMENT),this.attributes=[],this.uniforms=[],this.stride=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addAttribute=function(t){this.attributes.push(t),this.needsUpdate=!0},e.prototype.addUniform=function(t){this.uniforms.push(t),this.needsUpdate=!0},e.prototype.update=function(){this.stride=0;for(var t=0;t<this.attributes.length;t++){var e=this.attributes[t];e.offset=this.stride,this.stride+=4*e.size}},e}(R),et={bound:{sceneContext:void 0,program:void 0,viewport:new r},test:{depth:!1,stensil:!1},reset:function(){this.bound={sceneContext:void 0,program:void 0,viewport:new r},this.test={depth:!1,stensil:!1}}},nt={setup:function(t){var e={alpha:!0,premultipliedAlpha:!1};this._gl=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),this.context?this.context.reset():this.context=et},updateTexture:function(t,e){var n=this._gl;t.location||(t.location=n.createTexture()),n.activeTexture(n["TEXTURE"+e]),n.bindTexture(n.TEXTURE_2D,t.location),t.needsUpdate&&(t.needsUpdate=!1,n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),t.image?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])))},deleteTexture:function(t){t.location&&(this._gl.deleteTexture(t.location),t.location=void 0)},updateProgram:function(t){var e=this._gl;if(!t.location&&(t.location=e.createProgram(),this.updateShader(t.vertex),e.attachShader(t.location,t.vertex.location),this.updateShader(t.fragment),e.attachShader(t.location,t.fragment.location),e.linkProgram(t.location),this.deleteShader(t.vertex),this.deleteShader(t.fragment),!e.getProgramParameter(t.location,e.LINK_STATUS)))throw new Error("Could not initialise shaders");e.useProgram(t.location),this.context.bound.program=t,t.needsUpdate&&(t.update(),t.needsUpdate=!1);for(var n=0;n<t.attributes.length;n++)this.updateAttribute(t.attributes[n],t.stride);for(var o=0;o<t.uniforms.length;o++)this.updateUniform(t.uniformBuffer,t.uniforms[o])},deleteProgram:function(t){var e=this._gl;t.location&&e.deleteProgram(t.location)},updateShader:function(t){var e=this._gl;if(t.location||(t.location=e.createShader(e[t.type])),e.shaderSource(t.location,t.source),e.compileShader(t.location),!e.getShaderParameter(t.location,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(t.location))},deleteShader:function(t){var e=this._gl;t.location&&(e.deleteShader(t.location),t.location=void 0)},updateAttribute:function(t,e){var n=this._gl,o=t;if(!o.location){if(o.location=n.getAttribLocation(this.context.bound.program.location,o.name),o.location<0)throw new Error("attribute "+o.name+" undefined.");n.enableVertexAttribArray(o.location)}n.vertexAttribPointer(o.location,o.size,n[o.format],n.FALSE,e,o.offset)},updateUniform:function(t,e){var n=this._gl;switch(e.location||(e.location=n.getUniformLocation(this.context.bound.program.location,e.name)),e.name){case $.Binding.ModelView:n.uniformMatrix4fv(e.location,!1,bound.model.matrix.local.data);break;case $.Binding.Projection:n.uniformMatrix4fv(e.location,!1,bound.camera.matrix.projection.data);break;default:if(e.valueObject.value instanceof B)this.updateTexture(e.valueObject.value,e.textureUnit),n.uniform1i(e.location,e.textureUnit);else switch(e.shaderVarFormat){case H:n.uniform1i(e.location,e.valueObject.value);break;case G:n.uniform1f(e.location,e.valueObject.value);break;case q:n.uniform2fv(e.location,e.valueObject.value.data);break;case Y:n.uniform3fv(e.location,e.valueObject.value.data);break;case W:n.uniform4fv(e.location,e.valueObject.value.data);break;case K:n.uniformMatrix3fv(e.location,e.valueObject.value.data);break;case Q:n.uniformMatrix4fv(e.location,e.valueObject.value.data)}}},updateBuffer:function(t){var e,n=this._gl;t.location||(t.location=n.createBuffer()),e=t.bufferType!==L.Type.Index?n.ARRAY_BUFFER:n.ELEMENT_ARRAY_BUFFER,n.bindBuffer(e,t.location),t.needsUpdate&&(n.bufferData(e,t.data,n[t.usage]),t.needsUpdate=!1)},updateSceneContext:function(t){if(this.context.bound.sceneContext!==t){var e=this._gl;this.context.test.depth!=t.test.depth&&(t.test.depth?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.context.test.depth=t.test.depth),this.context.test.stencil!=t.test.stencil&&(t.test.stencil?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.context.test.stencil=t.test.stencil),this.context.bound.sceneContext=t}},updateCamera:function(t){this.context.bound.camera=t;var e=t.viewport;this.context.bound.viewport.equals(e)||(this.context.bound.viewport.set(e.x,e.y,e.z,e.w),this._gl.viewport(e.x,e.y,e.width,e.height))},clear:function(t){var e=this._gl,n=t,o=0;n.clear.color&&(e.clearColor(n.color.r,n.color.g,n.color.b,n.color.a),o|=e.COLOR_BUFFER_BIT),n.clear.depth&&(o|=e.DEPTH_BUFFER_BIT),n.clear.stencil&&(o|=e.STENCIL_BUFFER_BIT),e.clear(o)},renderModel:function(t){this.context.bound.model=t,t.scene&&this.updateSceneContext(t.scene.context),this.updateCamera(t.scene.camera),this.renderMesh(t.mesh)},renderMesh:function(t,e){var n=this._gl;this.updateBuffer(t.vertexBuffer),this.updateProgram(t.material.program);var o=t.indexBuffer;this.updateBuffer(o),n.drawElements(n[o.drawMode],o.limit,n[o.format],0)}},ot=function(){this.r=0,this.g=0,this.b=0,this.a=1};ot.prototype.set=function(t,e,n,o){this.r=t,this.g=e,this.b=n,this.a=o};var it=function(t){function e(){t.call(this),this.vertexBuffer=new L(U,L.Type.Interleaved,L.Usage.Static),this.indexBuffer=new j(j.DrawMode.Triangles)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(u),rt=function(t){function e(){t.call(this),this.children=[],this.matrix={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addChild=function(t){this.children.push(t),t.parent=this},e.prototype.removeChild=function(t){t.parent=void 0;var e=this.children.indexOf(t);e>-1&&this.children.splice(e,1)},e}(u),st=function(t){function e(){t.call(this),this.mesh=new it}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(rt),at=function(t){function e(){t.call(this),this.viewport=new r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setViewport=function(t,e,n,o){this.viewport.set(t,e,n,o)},e}(rt),ct=function(){this.clear={color:!0,depth:!1,stencil:!1},this.test={depth:!1,stencil:!1},this.color=new ot},ut=function(t){function e(){t.call(this),this.context=new ct,this.camera=new at}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addChild=function(e){e.parent&&e.parent.removeChild(e),t.prototype.addChild.call(this,e),e.scene=this},e.prototype.removeChild=function(e){t.prototype.removeChild.call(this,e),e.scene=void 0},e}(rt),pt=function(t){function e(e){t.call(this,e),this.program.addAttribute(new Z("position",U,q))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}((function(t){var e=this;if(this.program=new tt,this.program.vertex.updateSource(t.vertexShader),this.program.fragment.updateSource(t.fragmentShader),this.uniforms=t.uniforms,this.uniforms){var n=-1;Object.keys(this.uniforms).forEach((function(t){var o=e.uniforms[t];o.value instanceof B?e.program.addUniform(new $(t,o,++n)):e.program.addUniform(new $(t,o))}))}})),ht=function(t){function e(){t.call(this);var e=[-1,-1,1,-1,1,1,-1,1];this.mesh.vertexBuffer.allocate(e.length),this.mesh.vertexBuffer.put(e);var n=[0,1,2,0,2,3];this.mesh.indexBuffer.allocate(n.length),this.mesh.indexBuffer.put(n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={material:{configurable:!0}};return n.material.set=function(t){this.mesh.material=t},Object.defineProperties(e.prototype,n),e}(st),lt=function(n){function o(){n.call(this),this.scene=new ut,this.model=new ht,this.mesh=this.model.mesh,this.scene.addChild(this.model),this._uniform0={texture0:{value:new B},texture1:{value:new B},progress:{value:0},resolution:{value:new e(0,0)}}}return n&&(o.__proto__=n),o.prototype=Object.create(n&&n.prototype),o.prototype.constructor=o,o.prototype.setup=function(e,o){n.prototype.setup.call(this,e,o),nt.setup(this.canvas);var i=e.option.transition;this.mesh.material=new pt({vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,uniforms:t.extend(i.uniforms,this._uniform0)})},o.prototype.dispose=function(){n.prototype.dispose.call(this),nt.deleteProgram(this.mesh.material.program),this.mesh.material=void 0},o.prototype.render=function(t){n.prototype.render.call(this,t),nt.clear(this.scene.context),nt.renderModel(this.model)},o.prototype.resize=function(t,e){n.prototype.resize.call(this,t,e),this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),this.scene.camera.setViewport(0,0,t,e)},o}(D),dt=function(){this.dom=new _,this.time=0};dt.prototype.setup=function(){for(var e=this,n=[],o=arguments.length;o--;)n[o]=arguments[o];this.option=t.extend(c,n[1]||{}),this.dom.setup(n[0]),this.option.debug==c.Debug.DISPLAY.DOM&&this.dom.container.classList.add("xslider-debug"),this.list=[],this.dom.slides.forEach((function(t){e.list.push(new S(t,e.option.debug))}))},dt.prototype.dispose=function(){this.option&&(this.list.forEach((function(t){t.dispose()})),this.dom.dispose(),this.option=void 0)},dt.prototype.getRenderer=function(){return this.option.debug?new P:this.option.renderer||new lt};var ft=function(t){function e(){t.call(this),this._defineHandlers()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={enabled:{configurable:!0}};return e.prototype._defineHandlers=function(){var t=this;this._on={tick:function(n){n.time>t.option.delay&&t.dispatch(e.EVENT.TICK)}}},n.enabled.get=function(){return null!=this.option},e.prototype.setup=function(t){this.option=t},e.prototype.start=function(){this.enabled&&m.on("tick",this._on.tick)},e.prototype.stop=function(){this.enabled&&m.off("tick",this._on.tick)},Object.defineProperties(e.prototype,n),e}(u);ft.EVENT={TICK:"autoplay_tick"};var vt=function(t){function e(){t.call(this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={current:{configurable:!0},i0:{configurable:!0},i1:{configurable:!0}};return e.prototype.setup=function(t){this.data=t,this._target=t.option.initialSlideIndex,this._v=this._target-1,this._length=t.dom.slides.length,this._state=e.STATE.DEFAULT,this.progress=0,this.set({head:void 0,tail:void 0}),!this.data.option.loop&&(this._target=this.constrain(this._target)),this.tick()},e.prototype.prev=function(){this._target--,!this.data.option.loop&&(this._target=this.constrain(this._target))},e.prototype.next=function(){this._target++,!this.data.option.loop&&(this._target=this.constrain(this._target))},e.prototype.to=function(t){if(this.data.option.loop){var e,n,o=t-this.current;n=o>0?o>-(e=o-this._length)?e:o:-o>(e=o+this._length)?e:o,this._target+=n}else this._target=t},e.prototype.down=function(){this._state=e.STATE.DOWN,this._move=0},e.prototype.move=function(t){this._v+=t,this._move=t,!this.data.option.loop&&(this._v=this.constrain(this._v)),this._target=this._v},e.prototype.up=function(){this._state=e.STATE.UP,!this.data.option.get("throwable","touchMove")&&(this._move=0)},n.current.get=function(){var t=this._target%this._length+this._length;return Math.round(t)%this._length},n.i0.get=function(){return this._i0},n.i1.get=function(){return this._i1},e.prototype.constrain=function(t){var e=t<0?0:this._length-1<t?this._length-1:t;return this.set({head:0==e,tail:e==this._length-1}),e},e.prototype.tick=function(){var t=!1;switch(this._state){case e.STATE.DOWN:break;case e.STATE.UP:this._target+=this._move,!this.data.option.loop&&(this._target=this.constrain(this._target)),this._move*=.95,this._v=this._target,Math.abs(this._move)<.01&&(this._target=Math.round(this._v),this._state=e.STATE.DEFAULT);break;default:!this.data.option.loop&&(this._target=this.constrain(this._target)),this._v+=(this._target-this._v)*this.data.option.easing,Math.abs(this._target-this._v)<.001&&(this._v=this._target,t=!0)}var n=this._v%this._length+this._length;this.progress=n%1,this._i0=Math.floor(n)%this._length;var o=Math.ceil(n)%this._length;this._i1=this._i0!==o?o:void 0,t&&this.dispatch("complete")},Object.defineProperties(e.prototype,n),e}(u);vt.STATE={DEFAULT:"DEFAULT",DOWN:"DOWN",UP:"UP"};var gt=function(t){function e(){t.call(this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={active:{configurable:!0}};return e.prototype.setup=function(t){this.set({target:t})},n.active.set=function(t){var e=this.get("target");t?e.classList.remove("xslider-disabled"):e.classList.add("xslider-disabled")},e.prototype.dispose=function(){this.active=!0},Object.defineProperties(e.prototype,n),e}(v),mt=function(t){function e(){t.call(this),this._defineHandlers()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._defineHandlers=function(){var t=this;this._onClick=function(e){var n=t.list.indexOf(e.target);t.set({index:n})},this._onChangeIndex=function(e){void 0!==e.value0&&t.list[e.value0].classList.remove("xslider-active"),t.list[e.value].classList.add("xslider-active")}},e.prototype.setup=function(t){this.container=t.dom.pager,this.list=[];for(var e=t.dom.slides.length,n=0;n<e;n++){var o=document.createElement("span");this.container.appendChild(o),o.addEventListener("click",this._onClick),this.list.push(o)}this.on("index",this._onChangeIndex),this.set({index:t.option.initialSlideIndex})},e.prototype.dispose=function(){var t=this;this.off("index",this._onChangeIndex),this.set({index:void 0}),this.list.forEach((function(e){e.removeEventListener("click",t._onClick),t.container.removeChild(e)}))},e}(u),_t=function(t){function e(){t.call(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._defineHandlers=function(){var n=this;t.prototype._defineHandlers.call(this),this._onPrev=function(t){t.preventDefault(),n.dispatch(e.EVENT.PREV)},this._onNext=function(t){t.preventDefault(),n.dispatch(e.EVENT.NEXT)}},e.prototype.setup=function(t){var e=t.dom;this.set({target:e.view}),e.pager&&(this.pager=this.pager||new mt,this.pager.setup(t),this.pager.on("index",this._on.bubble)),e.prev&&(this.prev=this.prev||new gt,this.prev.setup(e.prev),this.prev.on("click",this._onPrev)),e.next&&(this.next=this.next||new gt,this.next.setup(e.next),this.next.on("click",this._onNext))},e.prototype.dispose=function(){this.pager&&(this.pager.off("index",this._on.bubble),this.pager.dispose()),this.prev&&(this.prev.off("click",this._offPrev),this.prev.dispose()),this.next&&(this.next.off("click",this._onNext),this.next.dispose())},e}(v);_t.EVENT={PREV:"ui_prev",NEXT:"ui_next"};var yt=function(t){function e(){t.call(this),this.indexer=new vt,this.renderer={default:new P,gl:void 0},this.ui=new _t,this.autoplay=new ft,this.container=new C,this._defineHandlers()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._defineHandlers=function(){var t=this;this._onResize=function(e){var n=t.dom.width,o=t.dom.height;return t.data.list.forEach((function(t){t.needsResize=!0})),t.renderer.default.resize(n,o),t.renderer.gl.resize(n,o),t.container.resize(n,o).then((function(){t.renderer.gl.render(t.indexer)}))},this._onCompleteSlide=function(){m.off("tick",t._onTick),t.data.option.get("touchMove")&&t.ui.on(f.START,t._onChange),t.ui.on("index",t._onChange),t.autoplay.start()},this._onTick=function(e){t.data.time=e.time,t.indexer.tick(),t.renderer.default.render(t.indexer),t.container.ready(t.indexer).then((function(){t.renderer.gl.render(t.indexer)}),(function(t){console.log("reject ::",t)})),t.ui.pager.set({index:t.indexer.current})},this._onChange=function(e){switch(e.type){case _t.EVENT.PREV:t.prev();break;case _t.EVENT.NEXT:case ft.EVENT.TICK:t.next();break;case"index":t.indexer.to(e.value),t.container.ready(t.indexer).then((function(){m.on("tick",t._onTick)}),(function(t){console.log("on index rejected : ",t)}));break;case"head":t.ui.prev&&(t.ui.prev.active=!t.indexer.get("head"));break;case"tail":t.ui.next&&(t.ui.next.active=!t.indexer.get("tail"));break;case f.START:m.on(f.MOVE,t._onChange),m.on(f.END,t._onChange),t.ui.off("index",t._onChange),t.indexer.down(),t.autoplay.stop(),m.on("tick",t._onTick);break;case f.MOVE:var n=(e.clientX-e.clientX0)/t.dom.width;t.indexer.move(-n);break;case f.END:m.off(f.MOVE,t._onChange),m.off(f.END,t._onChange),t.indexer.up()}}},e.prototype.setup=function(t,e){var n=this;this.renderer.gl=t,this.data=e,this.dom=e.dom,this.renderer.default.setup(this.data),this.renderer.gl=this.data.getRenderer(),this.renderer.gl.setup(this.data,this.container),this.container.setup(this.renderer.gl.mesh),this.ui.setup(this.data),this.indexer.setup(this.data),this.indexer.on("complete",this._onCompleteSlide),this.data.option.loop||(this.indexer.on("head",this._onChange),this.indexer.on("tail",this._onChange)),this.autoplay.on(ft.EVENT.TICK,this._onChange),this.autoplay.setup(this.data.option.autoplay),this.dom.on("resize",this._onResize),E.resolveFonts().then((function(){return n.container.ready(n.indexer)})).then(this._onResize).then((function(){n.ui.on("index",n._onChange),n.ui.on(_t.EVENT.PREV,n._onChange),n.ui.on(_t.EVENT.NEXT,n._onChange),n.data.option.get("touchMove")&&n.ui.on(f.START,n._onChange),n.autoplay.start(),m.on("tick",n._onTick)}),(function(t){console.log("first ready rejected : ",t)}))},e.prototype.prev=function(){this.data.option.get("touchMove")&&this.ui.off(f.START,this._onChange),this.autoplay.stop(),this.indexer.prev(),this.ui.pager.set({index:this.indexer.current})},e.prototype.next=function(){this.data.option.get("touchMove")&&this.ui.off(f.START,this._onChange),this.autoplay.stop(),this.indexer.next(),this.ui.pager.set({index:this.indexer.current})},e.prototype.dispose=function(){this.data&&(m.off("tick",this._onTick),m.off(f.MOVE,this._onChange),m.off(f.END,this._onChange),this.ui.off("index",this._onChange),this.ui.off(_t.EVENT.PREV,this._onChange),this.ui.off(_t.EVENT.NEXT,this._onChange),this.data.option.get("touchMove")&&this.ui.off(f.START,this._onChange),this.ui.dispose(),this.dom.off("resize",this._onResize),this.indexer.off("complete",this._onCompleteSlide),this.data.option.loop||(this.indexer.off("head",this._onChange),this.indexer.off("tail",this._onChange)),this.renderer.gl.dispose(),this.renderer.default.dispose(),this.container.dispose(),this.data=void 0)},e}(u),xt=function(e){function n(){for(var n,o=[],i=arguments.length;i--;)o[i]=arguments[i];e.call(this),this.data=new dt,this.controller=new yt,t.delegate(this,{prev:this.controller.prev,next:this.controller.next,autoplay:{start:this.controller.autoplay.start,stop:this.controller.autoplay.stop}}),(n=this).setup.apply(n,o)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.setup=function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];this.dispose(),(t=this.data).setup.apply(t,e),this.controller.setup(this.renderer,this.data)},n.prototype.dispose=function(){this.controller.dispose(),this.data.dispose()},n}(u),bt=a.extend({fragmentShader:"\nprecision highp float;\n\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform float progress;\nuniform vec2 resolution;\nuniform vec2 gradient;\n\nvoid main(void) {\n\tvec2 p = gl_FragCoord.xy /resolution.xy;\n\n\tfloat v = mix(0.0, 1.0, progress * (1.0+gradient.x+gradient.y) - ((1.0-p.x)*gradient.x+p.y*gradient.y));\n\tv = clamp(v, 0.0, 1.0);\n\n\tvec2 p0 = p;\n\tvec2 p1 = p;\n\n\tp0 -= 0.5;\n\tp0 *= (1.0 - v);\n\tp0 += 0.5;\n\n\tp1 -= 0.5;\n\tp1 *= v;\n\tp1 += 0.5;\n\n\tvec4 color0 = texture2D(texture0, p0);\n\tvec4 color1 = texture2D(texture1, p1);\n\n\tgl_FragColor = mix(color0, color1, v);\n}\n",uniforms:{gradient:{value:new e(.5,.5)}}}),wt=a.extend({fragmentShader:"\nprecision highp float;\n\n#define PI 3.141592653589793\n\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform float progress;\nuniform vec2 resolution;\n// uniform vec2 fade;\nuniform float strength;\n\n\nfloat Linear_ease(in float begin, in float change, in float duration, in float time) {\n    return change * time / duration + begin;\n}\n\nfloat Exponential_easeInOut(in float begin, in float change, in float duration, in float time) {\n    if (time == 0.0)\n        return begin;\n    else if (time == duration)\n        return begin + change;\n    time = time / (duration / 2.0);\n    if (time < 1.0)\n        return change / 2.0 * pow(2.0, 10.0 * (time - 1.0)) + begin;\n    return change / 2.0 * (-pow(2.0, -10.0 * (time - 1.0)) + 2.0) + begin;\n}\n\nfloat Sinusoidal_easeInOut(in float begin, in float change, in float duration, in float time) {\n    return -change / 2.0 * (cos(PI * time / duration) - 1.0) + begin;\n}\n\n/* random number between 0 and 1 */\nfloat hash(in vec3 scale, in float seed) {\n    /* use the fragment position for randomness */\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvec3 crossFade(in vec2 uv, in float dissolve) {\n    return mix(texture2D(texture0, uv).rgb, texture2D(texture1, uv).rgb, dissolve);\n}\n\nvoid main(void) {\n\tvec2 p = gl_FragCoord.xy /resolution.xy;\n\n\tvec2 center = vec2(Linear_ease(0.25, 0.5, 1.0, progress), 0.5);\n\tfloat dissolve = Exponential_easeInOut(0.0, 1.0, 1.0, progress);\n\tfloat strength = Sinusoidal_easeInOut(0.0, strength, 0.5, progress);\n\tvec3 color = vec3(0.0);\n\tfloat total = 0.0;\n\tvec2 toCenter = center - p;\n\tfloat offset = hash(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n\tfor (float t = 0.0; t <= 40.0; t++) {\n\t  float percent = (t + offset) / 40.0;\n\t  float weight = 4.0 * (percent - percent * percent);\n\t  color += crossFade(p + toCenter * percent * strength, dissolve) * weight;\n\t  total += weight;\n\t  gl_FragColor = vec4(color / total, 1.0);\n\t}\n}\n",uniforms:{strength:{value:1}}}),Et=a.extend({fragmentShader:"\nprecision highp float;\n\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform float progress;\nuniform vec2 resolution;\nuniform vec4 bgColor;\n\nuniform float floating;\nuniform float unzoom;\nuniform float perspective;\nuniform float reflection;\n\n\nvec2 project (vec2 p) {\n  return p * vec2(1.0, -1.2) + vec2(0.0, -floating/100.0);\n}\n\nbool inBounds (vec2 p) {\n  return all(lessThan(vec2(0.0), p)) && all(lessThan(p, vec2(1.0)));\n}\n\n/**\n * persp 0-1 1:正対\n * center 1.0:from 0.0:to\n */\nvec2 xskew (vec2 p, float persp, float center) {\n  float x = mix(p.x, 1.0-p.x, center);\n  float d = distance(center, 0.5);\n  return (\n    (vec2( x, (p.y - 0.5 * (1.0 - persp) * x) / (1.0 + (persp - 1.0) * x)) - vec2(0.5 - d, 0.0))\n    * vec2(0.5 / d * -sign(center-0.5), 1.0)\n    + vec2(center, 0.0)\n  );\n}\n\nvoid main(void) {\n\tvec2 uv = gl_FragCoord.xy /resolution.xy;\n\n\tfloat uz = unzoom * 2.0 * (0.5 - distance(0.5, progress));\n\tvec2 p = -uz * 0.5 + (1.0 + uz) * uv;\n\n\tvec2 fromP, toP;\n\n\tfromP = xskew(\n\t\tp / vec2(1.0-progress, 1.0),\n\t\tmix(1.0-progress, 1.0, perspective),\n\t\t1.0\n\t);\n\n\ttoP = xskew(\n\t\t(p - vec2(1.0-progress, 0.0)) / vec2(progress, 1.0),\n\t\t1.0 - mix(1.0-progress, 0.0, perspective),\n\t\t0.0\n\t);\n\n\tif (inBounds(fromP)) {\n\t\tgl_FragColor = texture2D(texture0, fromP);\n\t}\n\telse if (inBounds(toP)) {\n\t\tgl_FragColor = texture2D(texture1, toP);\n\t}\n\telse {\n\t\tfromP = project(fromP);\n\t\ttoP = project(toP);\n\n\t\tvec4 color0 = texture2D(texture0, fromP);\n\t\tvec4 color1 = texture2D(texture1, toP);\n\n\t\tgl_FragColor = bgColor\n\t\t\t+ float(inBounds(fromP)) * mix(bgColor, color0, reflection * mix(1.0, 0.0, fromP.y))\n\t\t\t+ float(inBounds(toP)) * mix(bgColor, color1, reflection * mix(1.0, 0.0, toP.y));\n\t}\n\n\n\n\n}\n",uniforms:{bgColor:{value:new r(.1,.1,.1,1)},unzoom:{value:.3},floating:{value:3},perspective:{value:.7},reflection:{value:.4}}}),Tt=a.extend({fragmentShader:"\nprecision highp float;\n\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform float progress;\nuniform vec2 resolution;\n// uniform vec2 fade;\nuniform float strength;\n\nvoid main(void) {\n\tvec2 p = gl_FragCoord.xy /resolution.xy;\n\n\tvec4 c0 = texture2D(texture0, p);\n\tvec4 c1 = texture2D(texture1, p);\n\n\tvec2 oa = (((c0.rg + c0.b) * 0.5) * 2.0 - 1.0);\n\tvec2 ob = (((c1.rg + c1.b) * 0.5) * 2.0 - 1.0);\n\tvec2 oc = mix(oa,ob,0.5)*strength;\n\n\t// float v = smoothstep(0.0, 1.0, progress * (1.0+fade.x+fade.y) - ((1.0-p.x)*fade.x+p.y*fade.y));\n\tfloat v = progress;\n\n\tc0 = texture2D(texture0, p + oc * v);\n\tc1 = texture2D(texture1, p - oc * (1.0 - v));\n\n\tgl_FragColor = mix(c0, c1, v);\n}\n",uniforms:{strength:{value:1}}}),St=a.extend({fragmentShader:"\nprecision highp float;\n\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform float progress;\nuniform vec2 resolution;\n// uniform vec2 fade;\n\nuniform float dark_low, dark_high, light_low, light_high;\nuniform float brightness, contrast, saturation;\nuniform vec3 light_tint, dark_tint;\n\nuniform float rgbOffsetOpt;\nuniform float horzFuzzOpt;\nuniform float zoom;\nuniform float time;\n\nuniform float t_amount, exposure;\n\nconst vec3 lumc = vec3(0.2125, 0.7154, 0.0721);\nconst vec3 avg_lum = vec3(0.5, 0.5, 0.5);\n\n\nvec3 tint(vec3 col)\n{\n\tfloat bri = (col.x + col.y + col.z)/3.0;\n\n\tfloat v = smoothstep(dark_low, dark_high, bri);\n\tcol = mix(dark_tint * bri, col, v);\n\n\tv = smoothstep(light_low, light_high, bri);\n\tcol = mix(col, min(light_tint * col, 1.0), v);\n\n\tvec3 intensity = vec3(dot(col.rgb, lumc));\n\tvec3 sat_color = mix(intensity, col.rgb, saturation);\n\tvec3 con_color = mix(avg_lum, sat_color, contrast);\n\t\n\treturn (con_color - 1.0 + brightness) * exposure;\n}\n\n// Noise generation functions borrowed from:\n// https://github.com/ashima/webgl-noise/blob/master/src/noise2D.glsl\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n\t// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n\t// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n\t// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n\t// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n\t// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n\t// Normalise gradients implicitly by scaling m\n\t// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n\t// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\nvoid main(void) {\n\n\tvec2 p =  gl_FragCoord.xy/resolution.xy;\n\tvec2 p0 = p;\n\tvec2 p1 = p;\n\n\tp0 -= 0.5;\n\tp1 -= 0.5;\n\tp0 *= 1.0 - progress * zoom;\n\tp1 *= 1.0 - (1.0 - progress) * zoom;\n\tp0 += 0.5;\n\tp1 += 0.5;\n\n\tfloat v = min(progress, 1.0 - progress) * 2.0;\t//0.0-1.0\n\n\tfloat fuzzOffset = snoise(vec2(time*15.0, p.y * 20.0)) * 0.0015;\n\tfloat largeFuzzOffset = snoise(vec2(time*1.0, p.y * 1.0)) * (0.003 + v * 0.01);\n\tfloat f_xoff = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt * progress;\n    float b_xoff = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt * (1.0 - progress);\n    \n    // float rgbOffset = rgbOffsetOpt * fuzzOffset * 300.0;\n    // float rgbOffset = rgbOffsetOpt;\n    float rgbOffset = snoise(vec2(time*15.0, 1.0)) * rgbOffsetOpt;\n\n\tvec3 f_col = vec3(\n\t\ttexture2D(texture0,\tvec2(p0.x + f_xoff -0.01 * rgbOffset * progress, p0.y)).r,\n\t\ttexture2D(texture0, vec2(p0.x + f_xoff,\t  p0.y)).g,\n\t\ttexture2D(texture0, vec2(p0.x + f_xoff +0.01 * rgbOffset * progress, p0.y)).b\n\t);\n\n\tvec3 b_col = vec3(\n\t\ttexture2D(texture1, vec2(p1.x + b_xoff -0.01 * rgbOffset * (1.0 - progress), p1.y)).r,\n\t\ttexture2D(texture1, vec2(p1.x + b_xoff,\t  p1.y)).g,\n\t\ttexture2D(texture1, vec2(p1.x + b_xoff +0.01 * rgbOffset * (1.0 - progress), p1.y)).b\n\t);\n\n\tvec3 ff_col = f_col;\n\tff_col = tint(ff_col);\n\tff_col = mix(f_col, ff_col, t_amount * progress);\n\n\tvec3 bb_col = b_col;\n\tbb_col = tint(bb_col);\n\tbb_col = mix(b_col, bb_col, t_amount * (1.0 - progress));\n\n\tgl_FragColor = vec4(mix(ff_col, bb_col, progress), 1.0);\n}\n",uniforms:{time:{value:0},zoom:{value:.3},dark_low:{value:100},dark_high:{value:200},dark_low:{value:200},dark_high:{value:255},contrast:{value:1},brightness:{value:1},saturation:{value:100},light_tint:{value:new o(.5,.5,.5)},dark_tint:{value:new o(.2,.2,.2)},t_amount:{value:.5},exposure:{value:30},horzFuzzOpt:{value:10},rgbOffsetOpt:{value:20}}}),Ct=a.extend({fragmentShader:"\nprecision highp float;\n\n\n#define N 10.0\n\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform float progress;\nuniform vec2 resolution;\n\nvoid main(void) {\n\tvec2 p = gl_FragCoord.xy /resolution;\t//0.0-1.0\n\tfloat aspect = resolution.x / resolution.y;\n\tfloat v = min(progress, 1.0 - progress) * 2.0;\t//0.0-1.0\n\tv = floor(v * 30.0) / 30.0;\n\n\tif(v > 0.0) {\n\t\tvec2 steps = vec2(aspect, 1.0) * N / v;\n\t\n\t\tp -= 0.5;\n\t\n\t\tsteps = min(steps, resolution.xy);\n\t\tp = (floor(p * steps) + 0.5) / steps;\n\t\n\t\tp += 0.5;\n\t}\n\n\tvec4 c0 = texture2D(texture0, p);\n\tvec4 c1 = texture2D(texture1, p);\n\n\tgl_FragColor = mix(c0, c1, progress);\n}\n",uniforms:{}}),Ot=a.extend({fragmentShader:"\n\nprecision highp float;\n\n#define N 10.0\n\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform float progress;\nuniform vec2 resolution;\nuniform vec2 gradient;\n\nvoid main(void) {\n\tvec2 p = gl_FragCoord.xy /resolution;\n\tfloat aspect = resolution.x / resolution.y;\n\n\tfloat v = mix(0.0, 1.0, progress * (1.0+gradient.x+gradient.y) - ((1.0-p.x)*gradient.x+p.y*gradient.y));\n\tv = clamp(v, 0.0, 1.0);\n\tv = floor(v * 16.0) / 16.0;\n\n\tif(v!=0.0) {\n\t\tp -= 0.5;\n\t\n\t\tfloat pv = min(v, 1.0 - v) * 2.0;\t//0.0-1.0\n\t\tvec2 steps = vec2(aspect, 1.0) * N / pv;\n\t\tsteps = min(steps, resolution.xy);\n\t\tp = (floor(p * steps) + 0.5) / steps;\n\t\n\t\tp += 0.5;\n\t}\n\n\tvec4 c0 = texture2D(texture0, p);\n\tvec4 c1 = texture2D(texture1, p);\n\n\t// v = step(0.5, v);\n\n\tgl_FragColor = mix(c0, c1, v);\n}\n",uniforms:{gradient:{value:new e(.5,0)}}});return xt.stage=m,xt.BaseTransition=a,xt.CrossWarpTransition=bt,xt.CrossZoomTransition=wt,xt.CubeTransition=Et,xt.MorphTransition=Tt,xt.NoiseTransition=St,xt.PixelateTransition=Ct,xt.PixelateWipeTransition=Ot,xt.Vec2=e,xt.Vec3=o,xt.Vec4=r,xt.Matrix3=V,xt.Matrix4=X,xt.Utils=t,xt.Debug=c.Debug,"undefined"!=typeof window&&(window.XSlider=xt),xt}));
