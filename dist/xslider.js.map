{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/get.js","webpack:///./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/superPropBase.js","webpack:///./node_modules/@babel/runtime/helpers/typeof.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/modules/SlideController.js","webpack:///./src/modules/components/AutoPlay.js","webpack:///./src/modules/components/Data.js","webpack:///./src/modules/components/Indexer.js","webpack:///./src/modules/components/Net.js","webpack:///./src/modules/components/Option.js","webpack:///./src/modules/components/Utils.js","webpack:///./src/modules/components/converter/Cloner.js","webpack:///./src/modules/components/converter/Inliner.js","webpack:///./src/modules/components/converter/SvgConverter.js","webpack:///./src/modules/components/graphics/GLGraphics.js","webpack:///./src/modules/components/graphics/Material.js","webpack:///./src/modules/components/graphics/Mesh.js","webpack:///./src/modules/components/graphics/assets/Asset.js","webpack:///./src/modules/components/graphics/assets/Buffer.js","webpack:///./src/modules/components/graphics/assets/Program.js","webpack:///./src/modules/components/graphics/assets/Texture.js","webpack:///./src/modules/components/graphics/nodes/Node.js","webpack:///./src/modules/components/graphics/nodes/Scene.js","webpack:///./src/modules/core/Environment.js","webpack:///./src/modules/core/Event.js","webpack:///./src/modules/core/EventDispatcher.js","webpack:///./src/modules/core/InteractiveObject.js","webpack:///./src/modules/core/Stage.js","webpack:///./src/modules/core/Ticker.js","webpack:///./src/modules/display/Button.js","webpack:///./src/modules/display/Dom.js","webpack:///./src/modules/display/Pager.js","webpack:///./src/modules/display/Slide.js","webpack:///./src/modules/display/UI.js","webpack:///./src/modules/display/XModel.js","webpack:///./src/modules/geom/Color.js","webpack:///./src/modules/geom/Matrix.js","webpack:///./src/modules/geom/Vec.js","webpack:///./src/modules/main.js","webpack:///./src/modules/renderer/BaseRenderer.js","webpack:///./src/modules/renderer/DefaultRenderer.js","webpack:///./src/modules/renderer/XRenderer.js","webpack:///./src/modules/transitions/BaseTransition.js","webpack:///./src/modules/transitions/CrossWarpTransition.js","webpack:///./src/modules/transitions/CrossZoomTransition.js","webpack:///./src/modules/transitions/CubeTransition.js","webpack:///./src/modules/transitions/MorphTransition.js","webpack:///./src/modules/transitions/NoiseTransition.js","webpack:///./src/modules/transitions/PixelateTransition.js","webpack:///./src/modules/transitions/PixelateWipeTransition.js","webpack:///./src/xslider.js","webpack:///./src/xslider.scss"],"names":["SlideController","indexer","Indexer","renderer","DefaultRenderer","gl","undefined","ui","UI","autoplay","AutoPlay","container","SlideContainer","_defineHandlers","_onResize","e","w","dom","width","h","height","data","list","forEach","slide","needsResize","resize","then","render","_onCompleteSlide","stage","off","_onTick","option","get","on","TouchEvent","START","_onChange","start","time","tick","ready","message","console","log","pager","set","index","current","type","EVENT","PREV","prev","NEXT","TICK","next","to","value","active","MOVE","END","down","stop","dx","clientX","clientX0","move","up","setup","getRenderer","mesh","loop","Inliner","resolveFonts","dispose","EventDispatcher","_on","delay","dispatch","enabled","Data","Dom","Utils","extend","Option","debug","Debug","DISPLAY","DOM","classList","add","slides","element","push","Slide","XRenderer","_target","initialSlideIndex","_v","_length","length","_state","STATE","DEFAULT","progress","constrain","d0","d1","diff","DOWN","_move","v","UP","ret","complete","Math","abs","round","easing","_i0","floor","i1","ceil","_i1","Net","WOFF","JPEG","mimes","image","src","Promise","resolve","reject","check","setTimeout","url","responseType","onChange","xhr","readyState","status","response","onTimeout","XMLHttpRequest","onreadystatechange","ontimeout","timeout","open","send","ext","parseExtension","blob","readBlob","bind","match","exec","reader","FileReader","mimeType","onloadend","result","split","readAsDataURL","net","selector","touchMove","throwable","transition","BaseTransition","property","module","SVG","IMG","base","o","Object","assign","entries","entry","delegate","clamp","min","max","getQuery","key","cached","_query","query","window","location","search","substring","parameters","i","paramName","decodeURIComponent","paramValue","Cloner","original","target","excludes","name","getPropertyValue","cssText","setProperty","getPropertyPriority","getOwnPropertyNames","clone","cloneNode","Element","copyStyle","getComputedStyle","style","hasChildNodes","children","childNodes","arr","child","p","childClone","insertChildAtIndex","all","parent","appendChild","insertBefore","cloneStyle","cloner","URL_REGEX","inlinedFontString","fontStrings","readFontRules","map","rule","inlineFonts","inlinedFontStrings","join","fontRules","document","styleSheets","j","ss","cssRules","CSSRule","FONT_FACE_RULE","string","_inline","inlineNode","node","inlineImage","urls","searchUrls","getDataURI","dataURI","replace","filter","isDataURI","inlineImageElement","inlineBackgroundImage","HTMLImageElement","onload","onerror","background","inlined","converter","parser","DOMParser","convert","setAttribute","svgString","svg","parseFromString","styleNode","createElement","createTextNode","getElementsByTagName","GraphicsContext","bound","sceneContext","program","viewport","Vec4","test","depth","stensil","reset","GLGraphics","canvas","params","alpha","premultipliedAlpha","_gl","getContext","context","updateTexture","texture","textureUnit","createTexture","activeTexture","bindTexture","TEXTURE_2D","needsUpdate","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","pixelStorei","UNPACK_FLIP_Y_WEBGL","texImage2D","RGBA","UNSIGNED_BYTE","Uint8Array","deleteTexture","updateProgram","createProgram","updateShader","vertex","attachShader","fragment","linkProgram","deleteShader","getProgramParameter","LINK_STATUS","Error","useProgram","update","attributes","updateAttribute","stride","uniforms","updateUniform","uniformBuffer","deleteProgram","shader","createShader","shaderSource","source","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","attribute","a","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","size","format","FALSE","offset","buffer","uniform","getUniformLocation","Uniform","Binding","ModelView","uniformMatrix4fv","model","matrix","local","Projection","camera","projection","valueObject","Texture","uniform1i","shaderVarFormat","ShaderVarFormat","Int","Float","uniform1f","Vector2","uniform2fv","Vector3","uniform3fv","Vector4","uniform4fv","Matrix3","uniformMatrix3fv","Matrix4","updateBuffer","createBuffer","bufferType","Buffer","Type","Index","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","bindBuffer","bufferData","usage","updateSceneContext","enable","DEPTH_TEST","disable","stencil","STENCIL_TEST","updateCamera","equals","x","y","z","clear","c","bits","color","clearColor","r","g","b","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","renderModel","scene","renderMesh","mat","vertexBuffer","material","bf","indexBuffer","drawElements","drawMode","limit","Material","Program","updateSource","vertexShader","fragmentShader","textureCount","keys","addUniform","Mesh","VarFormat","Interleaved","Usage","Static","IndexBuffer","DrawMode","Triangles","Asset","Byte","UnsignedByte","Short","UnsignedShort","UnsignedInt","getTypedArrayByFormat","Int8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","position","subarray","Array","tmp","Dynamic","Stream","getSizeFromShaderVarFormat","ShaderVar","varFormat","constructor","Vec2","Vec3","Shader","VERTEX","FRAGMENT","bytes_per_float","Image","Node","indexOf","splice","Model","Camera","SceneContext","Color","Scene3D","removeChild","Environment","info","XSLIDER_VERSION","support","touch","DocumentTouch","pointer","navigator","pointerEnabled","MSPointer","msPointerEnabled","env","Event","CHANGE","types","_listeners","_properties","properties","v0","value0","options","hasOwnProperty","listener","some","elem","InteractiveObject","changeTarget","bubble","_autoRemoveListener","touches","clientY","clientY0","touchStart","_autoAddListener","addEventListener","removeEventListener","Stage","ticker","Ticker","loaded","innerWidth","documentElement","clientWidth","innerHeight","clientHeight","fps","_defineFunctions","prefixes","requestAnimationFrame","cancelAnimationFrame","_tickHandler","_requestId","_lastMs","overlap","_nextMs","t0","_gap","_startMs","dt","_fps","Date","now","getTime","TweenMaxTicker","Button","flag","remove","_width","_height","querySelector","view","querySelectorAll","Pager","_onClick","_onChangeIndex","span","layer","inlinedNode","XMLSerializer","serializeToString","uri","encodeURIComponent","_svg0","replaceChild","loadImage","EXCLUDES","loadSvg","clearRect","drawImage","_onChangeSlide","removeOld","updateSlide","slide0","i0","slide1","resolution","slideIndex","_onPrev","preventDefault","_onNext","_offPrev","XMaterial","addAttribute","XModel","vertices","allocate","put","indices","identity","dst","sx","sy","s","sin","cos","fov","aspect","near","far","n2","PI","nf","T","tan","B","L","R","rx","ry","rz","sz","sinX","cosX","sinY","cosY","sinZ","cosZ","sinYsinX","sinYcosX","XSlider","controller","BaseRenderer","GLRenderer","_onUpdateTexture","webkitTransform","opacity","addChild","_uniform0","texture0","texture1","setViewport","gradient","CrossWarpTransition","CrossZoomTransition","strength","CubeTransition","bgColor","unzoom","floating","perspective","reflection","MorphTransition","NoiseTransition","zoom","dark_low","dark_high","PixelateTransition","PixelateWipeTransition","global"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,wC;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACA;;AAEA,iC;;;;;;;;;;;ACNA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,8B;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA;;AAEA,iC;;;;;;;;;;;ACfA,qBAAqB,mBAAO,CAAC,iFAAkB;;AAE/C,oBAAoB,mBAAO,CAAC,+EAAiB;;AAE7C;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,sB;;;;;;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;;AAEA,iC;;;;;;;;;;;ACPA,qBAAqB,mBAAO,CAAC,iFAAkB;;AAE/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,2B;;;;;;;;;;;ACjBA,cAAc,mBAAO,CAAC,0EAAmB;;AAEzC,4BAA4B,mBAAO,CAAC,+FAAyB;;AAE7D;AACA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","file":"dist/xslider.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/xslider.js\");\n","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nvar superPropBase = require(\"./superPropBase\");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","\r\nimport {TouchEvent} from './core/Event'\r\nimport {EventDispatcher} from './core/EventDispatcher'\r\nimport {stage} from './core/Stage'\r\nimport {AutoPlay} from './components/AutoPlay'\r\nimport {Indexer} from './components/Indexer'\r\nimport {Inliner} from './components/converter/Inliner'\r\n// import {Bench} from './components/debug/Bench'\r\nimport {SlideContainer} from './display/Slide'\r\nimport {UI} from './display/UI'\r\nimport {DefaultRenderer} from './renderer/DefaultRenderer'\r\n\r\n\r\n\r\nexport class SlideController extends EventDispatcher {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.indexer = new Indexer();\r\n\r\n\t\tthis.renderer = {\r\n\t\t\tdefault : new DefaultRenderer()\r\n\t\t\t, gl : undefined\r\n\t\t};\r\n\r\n\t\tthis.ui = new UI();\r\n\t\tthis.autoplay = new AutoPlay();\r\n\r\n\t\tthis.container = new SlideContainer();\r\n\r\n\t\tthis._defineHandlers();\r\n\t}\r\n\r\n\t_defineHandlers() {\r\n\r\n\t\tthis._onResize = (e) => {\r\n\t\t\tconst w = this.dom.width, h = this.dom.height;\r\n\r\n\t\t\tthis.data.list.forEach((slide) => {\r\n\t\t\t\tslide.needsResize = true;\r\n\t\t\t});\r\n\r\n\t\t\tthis.renderer.default.resize(w, h);\r\n\t\t\tthis.renderer.gl.resize(w, h);\r\n\r\n\t\t\treturn this.container.resize(w, h).then(() => {\r\n\t\t\t\tthis.renderer.gl.render(this.indexer);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\r\n\t\tthis._onCompleteSlide = () => {\r\n\t\t\tstage.off('tick', this._onTick);\r\n\t\t\tthis.data.option.get('touchMove') && this.ui.on(TouchEvent.START, this._onChange);\r\n\t\t\tthis.ui.on('index', this._onChange);\r\n\r\n\t\t\tthis.autoplay.start();\r\n\t\t}\r\n\r\n\r\n\t\tthis._onTick = (e) => {\r\n\t\t\tthis.data.time = e.time;\r\n\t\t\tthis.indexer.tick();\r\n\t\t\tthis.renderer.default.render(this.indexer);\r\n\t\t\tthis.container.ready(this.indexer)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tthis.renderer.gl.render(this.indexer);\r\n\t\t\t\t},\r\n\t\t\t\t(message) => {\r\n\t\t\t\t\tconsole.log(\"reject ::\", message);\r\n\t\t\t\t});\r\n\t\t\tthis.ui.pager.set({index:this.indexer.current});\r\n\t\t}\r\n\r\n\r\n\t\tthis._onChange = (e) => {\r\n\t\t\tswitch(e.type) {\r\n\t\t\t\tcase UI.EVENT.PREV:\r\n\t\t\t\t\tthis.prev();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase UI.EVENT.NEXT:\r\n\t\t\t\tcase AutoPlay.EVENT.TICK:\r\n\t\t\t\t\tthis.next();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'index':\r\n\t\t\t\t\tthis.indexer.to(e.value);\r\n\r\n\t\t\t\t\tthis.container.ready(this.indexer).then(() => {\r\n\t\t\t\t\t\tstage.on('tick', this._onTick);\r\n\t\t\t\t\t},\r\n\t\t\t\t\t(message) => {\r\n\t\t\t\t\t\tconsole.log('on index rejected : ', message);\r\n\t\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\t\tcase 'head':\r\n\t\t\t\t\tthis.ui.prev && (this.ui.prev.active = !this.indexer.get('head'));\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'tail':\r\n\t\t\t\t\tthis.ui.next && (this.ui.next.active = !this.indexer.get('tail'));\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TouchEvent.START:\r\n\t\t\t\t\tstage.on(TouchEvent.MOVE, this._onChange);\r\n\t\t\t\t\tstage.on(TouchEvent.END, this._onChange);\r\n\r\n\t\t\t\t\tthis.ui.off('index', this._onChange);\r\n\r\n\t\t\t\t\tthis.indexer.down();\r\n\r\n\t\t\t\t\tthis.autoplay.stop();\r\n\r\n\t\t\t\t\tstage.on('tick', this._onTick);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TouchEvent.MOVE:\r\n\t\t\t\t\tconst dx = (e.clientX - e.clientX0) / this.dom.width;\r\n\t\t\t\t\tthis.indexer.move(-dx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TouchEvent.END:\r\n\t\t\t\t\tstage.off(TouchEvent.MOVE, this._onChange);\r\n\t\t\t\t\tstage.off(TouchEvent.END, this._onChange);\r\n\r\n\t\t\t\t\tthis.indexer.up();\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tsetup(renderer, data) {\r\n\t\tthis.renderer.gl = renderer;\r\n\r\n\t\tthis.data = data;\r\n\t\tthis.dom = data.dom;\r\n\r\n\t\tthis.renderer.default.setup(this.data);\r\n\r\n\t\tthis.renderer.gl = this.data.getRenderer();\r\n\t\tthis.renderer.gl.setup(this.data, this.container);\r\n\r\n\t\tthis.container.setup(this.renderer.gl.mesh);\r\n\r\n\t\tthis.ui.setup(this.data);\r\n\r\n\t\tthis.indexer.setup(this.data);\r\n\t\tthis.indexer.on('complete', this._onCompleteSlide);\r\n\t\tif(!this.data.option.loop) {\r\n\t\t\tthis.indexer.on('head', this._onChange);\r\n\t\t\tthis.indexer.on('tail', this._onChange);\r\n\t\t}\r\n\r\n\t\tthis.autoplay.on(AutoPlay.EVENT.TICK, this._onChange);\r\n\t\tthis.autoplay.setup(this.data.option.autoplay);\r\n\r\n\t\tthis.dom.on('resize', this._onResize);\r\n\r\n\t\tInliner.resolveFonts()\r\n\t\t.then(() => this.container.ready(this.indexer))\r\n\t\t.then(this._onResize)\r\n\t\t.then(() => {\r\n\r\n\t\t\tthis.ui.on('index', this._onChange);\r\n\t\t\tthis.ui.on(UI.EVENT.PREV, this._onChange);\r\n\t\t\tthis.ui.on(UI.EVENT.NEXT, this._onChange);\r\n\r\n\t\t\tthis.data.option.get('touchMove') && this.ui.on(TouchEvent.START, this._onChange);\r\n\r\n\t\t\tthis.autoplay.start();\r\n\r\n\t\t\tstage.on('tick', this._onTick);\r\n\r\n\t\t}, (message) => {\r\n\t\t\tconsole.log(\"first ready rejected : \", message);\r\n\t\t});\r\n\t}\r\n\r\n\r\n\tprev() {\r\n\t\tthis.data.option.get('touchMove') && this.ui.off(TouchEvent.START, this._onChange);\r\n\t\tthis.autoplay.stop();\r\n\t\tthis.indexer.prev();\r\n\t\tthis.ui.pager.set({index:this.indexer.current});\r\n\t}\r\n\r\n\r\n\tnext() {\r\n\t\tthis.data.option.get('touchMove') && this.ui.off(TouchEvent.START, this._onChange);\r\n\t\tthis.autoplay.stop();\r\n\t\tthis.indexer.next();\r\n\t\tthis.ui.pager.set({index:this.indexer.current});\r\n\t}\r\n\r\n\r\n\tdispose() {\r\n\r\n\t\tif(!this.data) return;\r\n\r\n\t\tstage.off('tick', this._onTick);\r\n\t\tstage.off(TouchEvent.MOVE, this._onChange);\r\n\t\tstage.off(TouchEvent.END, this._onChange);\r\n\r\n\t\tthis.ui.off('index', this._onChange);\r\n\t\tthis.ui.off(UI.EVENT.PREV, this._onChange);\r\n\t\tthis.ui.off(UI.EVENT.NEXT, this._onChange);\r\n\r\n\t\tthis.data.option.get('touchMove') && this.ui.off(TouchEvent.START, this._onChange);\r\n\r\n\t\tthis.ui.dispose();\r\n\r\n\t\tthis.dom.off('resize', this._onResize);\r\n\r\n\t\tthis.indexer.off('complete', this._onCompleteSlide);\r\n\r\n\t\tif(!this.data.option.loop) {\r\n\t\t\tthis.indexer.off('head', this._onChange);\r\n\t\t\tthis.indexer.off('tail', this._onChange);\r\n\t\t}\r\n\r\n\t\tthis.renderer.gl.dispose();\r\n\t\tthis.renderer.default.dispose();\r\n\r\n\t\tthis.container.dispose();\r\n\r\n\t\tthis.data = undefined;\r\n\t}\r\n}\r\n\r\n","import {EventDispatcher} from '../core/EventDispatcher'\r\nimport {stage} from '../core/Stage'\r\n\r\nexport class AutoPlay extends EventDispatcher {\r\n    constructor() {\r\n        super();\r\n\r\n\t\tthis._defineHandlers();\r\n    }\r\n\r\n\r\n\t_defineHandlers() {\r\n        this._on = {\r\n            tick : (e) => {\r\n                if(e.time > this.option.delay) {\r\n                    this.dispatch(AutoPlay.EVENT.TICK);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    get enabled() {\r\n        return this.option != undefined;\r\n    }\r\n    \r\n\r\n    setup(option) {\r\n        this.option = option;\r\n    }\r\n\r\n\r\n    start() {\r\n        if(this.enabled) {\r\n            stage.on('tick', this._on.tick);\r\n        }\r\n    }\r\n\r\n\r\n    stop() {\r\n        if(this.enabled) {\r\n            stage.off('tick', this._on.tick);\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\nAutoPlay.EVENT = {\r\n    TICK:\"autoplay_tick\"\r\n}","import { Option } from './Option'\r\nimport { Utils } from './Utils'\r\nimport { Dom } from '../display/Dom'\r\nimport { Slide } from '../display/Slide'\r\nimport { DefaultRenderer } from '../renderer/DefaultRenderer'\r\n// import {ThreeRenderer} from '../renderer/ThreeRenderer'\r\nimport { XRenderer } from '../renderer/XRenderer'\r\n\r\n\r\n\r\n\r\nexport class Data {\r\n\tconstructor() {\r\n\t\tthis.dom = new Dom();\r\n\t\tthis.time = 0;\r\n\t}\r\n\r\n\tsetup(...args) {\r\n\r\n\t\tthis.option = Utils.extend(Option, args[1] || {});\r\n\r\n\t\tthis.dom.setup(args[0]);\r\n\r\n\t\tif (this.option.debug == Option.Debug.DISPLAY.DOM) {\r\n\t\t\tthis.dom.container.classList.add(\"xslider-debug\");\r\n\t\t}\r\n\r\n\t\tthis.list = [];\r\n\r\n\t\tthis.dom.slides.forEach(element => {\r\n\t\t\tthis.list.push(new Slide(element, this.option.debug));\r\n\t\t})\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tif (!this.option) return;\r\n\r\n\t\tthis.list.forEach(slide => {\r\n\t\t\tslide.dispose();\r\n\t\t})\r\n\t\tthis.dom.dispose();\r\n\r\n\t\tthis.option = undefined;\r\n\t}\r\n\r\n\tgetRenderer() {\r\n\t\tif (this.option.debug) {\r\n\t\t\treturn new DefaultRenderer();\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// return this.option.renderer || new ThreeRenderer();\r\n\t\t\treturn this.option.renderer || new XRenderer();\r\n\t\t}\r\n\t}\r\n}","import {EventDispatcher} from '../core/EventDispatcher'\r\n\r\nexport class Indexer extends EventDispatcher {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tsetup(data) {\r\n\t\tthis.data = data;\r\n\r\n\t\tthis._target = data.option.initialSlideIndex;\r\n\t\tthis._v = this._target-1;\r\n\t\tthis._length = data.dom.slides.length;\r\n\r\n\t\tthis._state = Indexer.STATE.DEFAULT;\r\n\r\n\t\tthis.progress = 0;\r\n\r\n\r\n\t\tthis.set({\r\n\t\t\t'head':undefined,\r\n\t\t\t'tail':undefined\r\n\t\t});\r\n\t\t!this.data.option.loop && (this._target = this.constrain(this._target));\r\n\r\n\t\tthis.tick();\r\n\t}\r\n\r\n\tprev() {\r\n\t\tthis._target--;\r\n\r\n\t\t!this.data.option.loop && (this._target = this.constrain(this._target));\r\n\t}\r\n\r\n\tnext() {\r\n\t\tthis._target++;\r\n\r\n\t\t!this.data.option.loop && (this._target = this.constrain(this._target));\r\n\t}\r\n\r\n\tto(index) {\r\n\t\tif(this.data.option.loop) {\r\n\t\t\tlet d0 = index - this.current, d1, diff;\r\n\r\n\t\t\tif(d0 > 0) {\r\n\t\t\t\td1 = d0 - this._length;\r\n\t\t\t\tdiff = d0 > -d1 ? d1 : d0;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\td1 = d0 + this._length;\r\n\t\t\t\tdiff = -d0 > d1 ? d1 : d0;\r\n\t\t\t}\r\n\r\n\t\t\tthis._target += diff;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._target = index;\r\n\t\t}\r\n\t}\r\n\r\n\tdown() {\r\n\t\tthis._state = Indexer.STATE.DOWN;\r\n\t\tthis._move = 0;\r\n\t}\r\n\r\n\tmove(v) {\r\n\t\tthis._v+=v;\r\n\t\tthis._move = v;\r\n\r\n\t\t!this.data.option.loop && (this._v = this.constrain(this._v));\r\n\r\n\t\tthis._target = this._v;\r\n\t}\r\n\r\n\tup() {\r\n\t\tthis._state = Indexer.STATE.UP;\r\n\t\t\r\n\t\t!this.data.option.get('throwable', 'touchMove') && (this._move = 0);\r\n\t}\r\n\r\n\tget current() {\r\n\t\tconst v = this._target % this._length + this._length;\r\n\t\treturn Math.round(v) % this._length;\r\n\t}\r\n\r\n\tget i0() {\r\n\t\treturn this._i0;\r\n\t}\r\n\r\n\tget i1() {\r\n\t\treturn this._i1;\r\n\t}\r\n\r\n\tconstrain(v) {\r\n\t\tconst ret = v < 0 ? 0 : this._length-1 < v ? this._length-1 : v;\r\n\t\tthis.set({\r\n\t\t\t'head':ret==0,\r\n\t\t\t'tail':ret==this._length-1\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\ttick() {\r\n\r\n\t\tlet complete = false;\r\n\r\n\t\tswitch(this._state) {\r\n\t\t\tcase Indexer.STATE.DOWN:\r\n\t\t\tbreak;\r\n\r\n\t\t\tcase Indexer.STATE.UP:\r\n\t\t\t\tthis._target += this._move;\r\n\r\n\t\t\t\t!this.data.option.loop && (this._target = this.constrain(this._target));\r\n\r\n\t\t\t\tthis._move *= 0.95;\r\n\t\t\t\tthis._v = this._target;\r\n\r\n\t\t\t\tif(Math.abs(this._move) < 0.01) {\r\n\t\t\t\t\tthis._target = Math.round(this._v);\r\n\t\t\t\t\tthis._state = Indexer.STATE.DEFAULT;\r\n\t\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\t!this.data.option.loop && (this._target = this.constrain(this._target));\r\n\r\n\t\t\t\tthis._v += (this._target - this._v) * this.data.option.easing;\r\n\r\n\t\t\t\tif(Math.abs(this._target - this._v) < 0.001) {\r\n\t\t\t\t\tthis._v = this._target;\r\n\t\t\t\t\tcomplete = true;\r\n\t\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tconst v = this._v % this._length + this._length;\r\n\t\tthis.progress = v % 1;\r\n\t\tthis._i0 = Math.floor(v) % this._length;\r\n\t\tconst i1 = Math.ceil(v) % this._length;\r\n\t\tthis._i1 = this._i0 !== i1 ? i1 : undefined;\r\n\r\n\t\tcomplete &&\tthis.dispatch('complete');\r\n\t}\r\n}\r\n\r\nIndexer.STATE = {\r\n\tDEFAULT:'DEFAULT',\r\n\tDOWN:'DOWN',\r\n\tUP:'UP'\r\n};","class Net {\r\n\tconstructor() {\r\n\t\t/*\r\n\t\t * Only WOFF and EOT mime types for fonts are 'real'\r\n\t\t * see http://www.iana.org/assignments/media-types/media-types.xhtml\r\n\t\t */\r\n\t\tvar WOFF = 'application/font-woff';\r\n\t\tvar JPEG = 'image/jpeg';\r\n\r\n\t\tthis.mimes = {\r\n\t\t\t'woff': WOFF,\r\n\t\t\t'woff2': WOFF,\r\n\t\t\t'ttf': 'application/font-truetype',\r\n\t\t\t'eot': 'application/vnd.ms-fontobject',\r\n\t\t\t'png': 'image/png',\r\n\t\t\t'jpg': JPEG,\r\n\t\t\t'jpeg': JPEG,\r\n\t\t\t'gif': 'image/gif',\r\n\t\t\t'tiff': 'image/tiff',\r\n\t\t\t'svg': 'image/svg+xml'\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tloadImage(image, src) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\tconst check = () => {\r\n\t\t\t\tif(!image.complete) {\r\n\t\t\t\t\tsetTimeout(check, 10);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\timage.src = src;\r\n\r\n\t\t\tcheck();\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tget(url, responseType) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\tconst onChange = () => {\r\n\t\t\t\tswitch ( xhr.readyState ) {\r\n\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\tif(xhr.status == 200 || xhr.status == 304) {\r\n\t\t\t\t\t\t\tresolve(xhr.response);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\treject();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tconst onTimeout = () => {\r\n\t\t\t\treject();\r\n\t\t\t};\r\n\r\n\t\t\tconst xhr = new XMLHttpRequest();\r\n\t\t\txhr.onreadystatechange = onChange;\r\n\t\t\txhr.ontimeout = onTimeout;\r\n\t\t\txhr.responseType = responseType;\r\n\t\t\txhr.timeout = 30000;\r\n\t\t\txhr.open('GET', url, true);\r\n\t\t\txhr.send(null);\r\n\t\t});\r\n\t}\r\n\r\n\r\n\t// async getDataURI(url) {\r\n\t// \tlet blob;\r\n\t// \tblob = await this.get(url, 'blob');\r\n\t// \tblob = await this.readBlob(blob);\r\n\t// \treturn blob;\r\n\t// }\r\n\tgetDataURI(url) {\r\n\t\tlet ext = this.parseExtension(url)\r\n\r\n\t\treturn this.get(url, 'blob')\r\n\t\t\t.then((blob) => {\r\n\t\t\t\treturn this.readBlob.bind(this)(blob, ext)\r\n\t\t\t});\r\n\t}\r\n\r\n\tparseExtension(url) {\r\n\t\tvar match = /\\.([^\\.\\/]*?)$/g.exec(url)\r\n\t\tif (match) return match[1]\r\n\t\telse return null\r\n\t}\r\n\r\n\tgetMimeType(ext) {\r\n\t}\r\n\r\n\treadBlob(blob, ext) {\r\n\t\tconst reader = new FileReader(),\r\n\t\tmimeType = ext ? this.mimes[ext] : null;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\treader.onloadend = () => {\r\n\t\t\t\tlet ret = reader.result\r\n\t\t\t\tif(mimeType) {\r\n\t\t\t\t\tret = ret.split(',')[1]\r\n\t\t\t\t\tret = 'data:' + mimeType + ';base64,' + ret;\r\n\t\t\t\t}\r\n\t\t\t\tresolve(ret)\r\n\t\t\t};\r\n\t\t\treader.readAsDataURL(blob);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport const net = new Net();","import {BaseTransition} from '../transitions/BaseTransition'\r\n\r\n\r\nexport const Option = {\r\n\t\t\r\n\t//default value\r\n\tselector : \"#xslider\",\r\n\tinitialSlideIndex : 0,\r\n\tautoplay : false,\r\n\tloop : true,\r\n\ttouchMove : {\r\n\t\tthrowable : true\r\n\t},\r\n\trenderer : undefined,\r\n\tdebug : false,\r\n\teasing: 0.15,\r\n\t\r\n\ttransition: BaseTransition,\r\n\r\n\tget : function(property, module) {\r\n\t\tif(module) {\r\n\t\t\tif(!this[module]) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn this[module][property];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this[property];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Debug = {\r\n\tDISPLAY: {\r\n\t\tDOM:\"DEBUG_DISPLAY_DOM\",\r\n\t\tSVG:\"DEBUG_DISPLAY_SVG\",\r\n\t\tIMG:\"DEBUG_DISPLAY_IMG\"\r\n\t}\r\n}","export const Utils = {\r\n\r\n\textend(base, o) {\r\n\t\tconst ret = {};\r\n\t\tObject.assign(ret, base);\r\n\r\n\t\tconst entries = Object.entries(o);\r\n\t\tentries.forEach(entry => {\r\n\t\t\tret[entry[0]] = entry[1];\r\n\t\t})\r\n\r\n\t\treturn ret;\r\n\t},\r\n\r\n\tdelegate(base, o) {\r\n\t\tconst entries = Object.entries(o);\r\n\t\tentries.forEach(entry => {\r\n\t\t\tbase[entry[0]] = entry[1];\r\n\t\t})\r\n\t},\r\n\r\n\tclamp(v, min, max) {\r\n\t\treturn Math.max(min, Math.min(max, v));\r\n\t},\r\n\r\n\tgetQuery(key, cached = true) {\r\n\r\n\t\tif (!this._query || !cached) {\r\n\t\t\tthis._query = {};\r\n\t\t\t//?\r\n\t\t\tlet query = window.location.search.substring(1);\r\n\t\t\tlet parameters = query.split('&');\r\n\t\t\tfor (let i = 0; i < parameters.length; i++) {\r\n\t\t\t\tlet element = parameters[i].split(\"=\");\r\n\t\t\t\tlet paramName = decodeURIComponent(element[0]);\r\n\t\t\t\tlet paramValue = decodeURIComponent(element[1]);\r\n\t\t\t\tthis._query[paramName] = paramValue;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._query[key];\r\n\t}\r\n\r\n\t// toSvg(dom) {\r\n\r\n\r\n\r\n\t// \treturn new Promise((resolve, reject) => {\r\n\r\n\t// \t\tdomtoimage.toSvg(dom)\r\n\t// \t\t\t.then((uri) => {\r\n\t// \t\t\t\t// console.log('uri: ', uri);\r\n\t// \t\t\t\tconst svgString = uri.replace(\"data:image/svg+xml;charset=utf-8,\",\"\");\r\n\r\n\t// \t\t\t\tconst parser = new DOMParser();\r\n\t// \t\t\t\tconst svg = parser.parseFromString(svgString, \"image/svg+xml\");\r\n\r\n\t// \t\t\t\tresolve(svg);\r\n\t// \t\t\t});\r\n\t// \t});\r\n\t// }\r\n}","\r\n\r\nclass Cloner {\r\n\tconstructor() {\r\n\r\n\t}\r\n\r\n\tcopyStyle(original, target, excludes) {\r\n\r\n\t\tlet o = {};\r\n\t\t\r\n\t\tif(excludes && excludes.length > 0) {\r\n\t\t\tfor(let i=0; i<excludes.length; i++) {\r\n\t\t\t\tlet name = excludes[i];\r\n\t\t\t\to[name] = target.getPropertyValue(name);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(original.cssText) {\r\n\t\t\ttarget.cssText = original.cssText;\r\n\r\n\t\t\t//remove fontStrech\r\n\t\t\t// const matches = target.cssText.match(/font:( [^ ;]+)+;/);\r\n\t\t\t// if(matches) {\r\n\t\t\t// \tconst removeFontStrech = s => {\r\n\t\t\t// \t\tlet arr = s.split(\" \");\r\n\t\t\t// \t\tarr.splice(3, 1);\r\n\t\t\t// \t\treturn arr.join(\" \");\r\n\t\t\t// \t};\r\n\t\t\t// \tfor(let i=0; i<matches.length; i++) {\r\n\t\t\t// \t\ttarget.cssText = target.cssText.replace(matches[i], removeFontStrech(matches[i]));\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfor(let i=0; i<original.length; i++) {\r\n\t\t\t\tlet name = original[i];\r\n\t\t\t\ttarget.setProperty(name, original.getPropertyValue(name), original.getPropertyPriority(name));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tObject.getOwnPropertyNames(o).forEach((name) => {\r\n\t\t\ttarget.setProperty(name, o[name]);\r\n\t\t});\r\n\t}\r\n\r\n\tcloneNode(original) {\r\n\t\tconst clone = original.cloneNode(false);\r\n\r\n        return new Promise((resolve, reject) => {\r\n\t\t\t\t\r\n\t\t\tif(!(original instanceof Element)) {\r\n\t\t\t\tresolve(clone);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.copyStyle(window.getComputedStyle(original), clone.style);\r\n\t\r\n\t\t\t\tif (original.hasChildNodes()) {\r\n\t\t\t\t\tconst children = original.childNodes;\r\n\t\r\n\t\t\t\t\tconst arr = [];\r\n\t\r\n\t\t\t\t\tchildren.forEach((child, i, list) => {\r\n\t\t\t\t\t\tlet p = this.cloneNode(child)\r\n\t\t\t\t\t\t\t.then((childClone) => {\r\n\t\t\t\t\t\t\t\t// clone.appendChild(childClone);\r\n\t\t\t\t\t\t\t\tthis.insertChildAtIndex(clone, childClone, i);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tarr.push(p);\r\n\t\t\t\t\t});\r\n\t\r\n\t\t\t\t\tPromise.all(arr).then(()=> {\r\n\t\t\t\t\t\tresolve(clone);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tresolve(clone);\r\n\t\t\t\t}\r\n\t\t\t}\r\n        })\r\n\t}\r\n\r\n\tinsertChildAtIndex(parent, child, index) {\r\n\t\tif(!index) index = 0;\r\n\t\tif(index >= parent.childNodes.length) {\r\n\t\t\tparent.appendChild(child);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tparent.insertBefore(child, parent.childNodes[index]);\r\n\t\t}\r\n\t}\r\n\r\n\tcloneStyle(original, target, excludes) {\r\n\r\n\t\tif(!(original instanceof Element)) return target;\r\n\t\t\r\n\t\tthis.copyStyle(window.getComputedStyle(original), target.style, excludes);\r\n\r\n        if (original.hasChildNodes()) {\r\n\r\n        \tconst children = original.childNodes;\r\n        \tchildren.forEach((child, i, list) => {\r\n        \t\tthis.cloneStyle(child, target.childNodes[i], excludes);\r\n        \t});\r\n        }\r\n        else {\r\n\t\t\treturn target;\r\n        }\r\n\t}\r\n}\r\n\r\nexport const cloner = new Cloner();","import {cloner} from './Cloner'\r\nimport {net} from '../Net'\r\n\r\n\r\nexport const Inliner = {\r\n\r\n\tURL_REGEX : /url\\(['\"]?([^'\"]+?)['\"]?\\)/g,\r\n\r\n\r\n\tresolveFonts() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif(this.inlinedFontString) {\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst fontStrings = this.readFontRules().map((rule) => rule.cssText);\r\n\t\t\t\tthis.inlineFonts(fontStrings)\r\n\t\t\t\t\t.then((inlinedFontStrings) => {\r\n\t\t\t\t\t\tthis.inlinedFontString = inlinedFontStrings.join(\" \");\r\n\t\t\t\t\t\t// this.inlinedFontString = inlinedFontStrings.join(\"\\n\");\r\n\t\t\t\t\t\t// console.log(\"this.inlinedFontString\", this.inlinedFontString)\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t},\r\n\r\n\treadFontRules() {\r\n\r\n\t\tconst fontRules = [];\r\n\r\n\t\tconst list = document.styleSheets;\r\n\r\n\t\tfor(let j=0; j<list.length; j++) {\r\n\t\t\tlet ss = list[j];\r\n\r\n\t\t\tif(ss.cssRules) {\r\n\t\t\t\tfor(let i=0; i<ss.cssRules.length; i++) {\r\n\t\t\t\t\tlet rule = ss.cssRules[i];\r\n\t\t\t\t\tif(rule.type === CSSRule.FONT_FACE_RULE) {\r\n\t\t\t\t\t\tfontRules.push(rule);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// console.log(\"fontRules\", fontRules)\r\n\r\n\t\treturn fontRules;\r\n\t},\r\n\r\n\tinlineFonts(fontStrings) {\r\n\t\tconst arr = fontStrings.map((string) => this._inline(string));\r\n\t\treturn Promise.all(arr);\r\n\t},\r\n\r\n\r\n\tinlineNode(node) {\r\n\t\treturn cloner.cloneNode(node)\r\n\t\t\t.then(this.inlineImage.bind(this))\r\n\t},\r\n\r\n\r\n\t_inline(string) {\r\n\t\t// console.log('string', string)\r\n\t\tconst urls = this.searchUrls(string);\r\n\t\tconst arr = [];\r\n\r\n\t\turls.map((url) => {\r\n\t\t\tconst p = net.getDataURI(url)\r\n\t\t\t\t.then((dataURI) => {\r\n\t\t\t\t\tstring = string.replace(url, dataURI);\r\n\t\t\t\t});\r\n\t\t\tarr.push(p);\r\n\t\t});\r\n\r\n\t\treturn Promise.all(arr).then(() => string);\r\n\t},\r\n\r\n\r\n\tsearchUrls(string) {\r\n        const result = [];\r\n        let match;\r\n        while ((match = this.URL_REGEX.exec(string)) !== null) {\r\n            result.push(match[1]);\r\n        }\r\n        return result.filter((url) => {\r\n            return this.isDataURI(url);\r\n        });\r\n\t},\r\n\r\n\r\n\tinlineImage(node) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tPromise.resolve(node)\r\n\t\t\t\t.then(this.inlineImageElement.bind(this))\r\n\t\t\t\t.then(this.inlineBackgroundImage.bind(this))\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tif(node.hasChildNodes()) {\r\n\t\t\t\t        const children = node.childNodes;\r\n\t\t\t\t\t\tconst arr = [];\r\n\r\n\t\t\t\t        children.forEach((child, i, list) => {\r\n\t\t\t\t        \tlet p = this.inlineImage(child);\r\n\t\t\t\t        \tarr.push(p);\r\n\t\t\t\t    \t});\r\n\r\n\t\t\t\t    \tPromise.all(arr).then(()=> {\r\n\t\t\t\t    \t\tresolve(node);\r\n\t\t\t\t    \t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tresolve(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\r\n\tinlineImageElement: function(node) {\r\n\t\tif(!(node instanceof HTMLImageElement)) return node;\r\n\r\n\t\tif(this.isDataURI(node.src)) return node;\r\n\r\n\t\t// return node;\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\tnet.getDataURI(node.src)\r\n\t\t\t\t.then((dataURI) => {\r\n\t\t\t\t\tnode.onload = () => {\r\n\t\t\t\t\t\tresolve(node);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnode.onerror = reject;\r\n\t\t\t\t\tnode.src = dataURI;\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\r\n\tinlineBackgroundImage(node) {\r\n\t\tif(!(node instanceof Element)) return node;\r\n\r\n\t\tconst background = node.style.getPropertyValue('background');\r\n\t\tif(!background) return node;\r\n\r\n\t\treturn this._inline(background)\r\n\t\t\t.then((inlined) => {\r\n                node.style.setProperty('background', inlined);\r\n                return node;\r\n\t\t\t});\r\n\t},\r\n\r\n\r\n\tisDataURI(string) {\r\n\t\treturn string.search(/^(data:)/) === -1;\r\n\t}\r\n\r\n\t\r\n}","import {Inliner} from './Inliner'\r\n\r\n/**\r\n * It's based on {@link https://github.com/tsayen/dom-to-image dom-to-image by Anatolii Saienko}.\r\n */\r\nexport const converter = {\r\n\tparser : new DOMParser(),\r\n\r\n\tconvert(node, width, height) {\r\n/*\r\n\t\tconst svgString = `\r\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"`+width+`\" height=\"`+height+`\">\r\n\t<foreignObject x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">\r\n\t\t<body xmlns=\"http://www.w3.org/1999/xhtml\" style=\"margin:0;\">\r\n\t\t\t<style>`+Inliner.inlinedFontString+`</style>\r\n\t\t</body>\r\n\t</foreignObject>\r\n</svg>\r\n\t\t`\r\n\t\t// console.log('--')\r\n\t\t// console.log(Inliner.inlinedFontString)\r\n\t\tconst svg = this.parser.parseFromString(svgString, \"text/xml\");\r\n\t\tlet o = svg.getElementsByTagName('body')[0];\r\n\t\to.appendChild(node);\r\n*/\r\n\t\tnode.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');\r\n\r\n\t\tconst svgString = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"`+width+`\" height=\"`+height+`\">\r\n\t\t<foreignObject x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">\r\n\t\t</foreignObject>\r\n\t\t</svg>`\r\n\r\n\t\tconst svg = this.parser.parseFromString(svgString, \"text/xml\"),\r\n\t\tstyleNode = document.createElement('style')\r\n\r\n\t\tstyleNode.appendChild(document.createTextNode(Inliner.inlinedFontString));\r\n\t\tnode.appendChild(styleNode)\r\n\r\n\t\tlet o = svg.getElementsByTagName('foreignObject')[0];\r\n\t\to.appendChild(node);\r\n\r\n\t\t// console.log('svg: ', svg.childNodes[0]);\r\n\r\n\t\treturn svg;\r\n\t},\r\n}","import {Buffer} from './assets/Buffer'\r\nimport {ShaderVarFormat, Uniform} from './assets/Program'\r\nimport {Texture} from './assets/Texture'\r\nimport { Vec4 } from '../../geom/Vec';\r\n\r\n\r\nconst GraphicsContext = {\r\n    bound: {\r\n        sceneContext: undefined,\r\n        program: undefined,\r\n        viewport: new Vec4()\r\n    },\r\n\r\n    test: {\r\n        depth: false,\r\n        stensil: false\r\n    },\r\n\r\n    reset: function() {\r\n        this.bound = {\r\n            sceneContext: undefined,\r\n            program: undefined,\r\n            viewport: new Vec4()\r\n        }\r\n\r\n        this.test = {\r\n            depth: false,\r\n            stensil: false\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const GLGraphics =  {\r\n\r\n    setup: function(canvas) {\r\n        const params = {\r\n            alpha: true,\r\n            premultipliedAlpha: false\r\n        }\r\n        this._gl = canvas.getContext(\"webgl\", params) || canvas.getContext(\"experimental-webgl\", params);\r\n        if(!this.context) {\r\n            this.context = GraphicsContext;\r\n        }\r\n        else {\r\n            this.context.reset();\r\n        }\r\n    },\r\n\r\n    updateTexture: function(texture, textureUnit) {\r\n        const gl = this._gl;\r\n\r\n        if(!texture.location) {\r\n            texture.location = gl.createTexture();\r\n        }\r\n\r\n        gl.activeTexture(gl[\"TEXTURE\"+textureUnit]);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture.location);\r\n\r\n        if(texture.needsUpdate) {\r\n            texture.needsUpdate = false;\r\n\r\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\r\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\r\n\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n\r\n            gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\r\n            if(texture.image) {\r\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, texture.image);\r\n            }\r\n            else {\r\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array([0,0,0,0]));\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    deleteTexture: function(texture) {\r\n        if(texture.location) {\r\n            this._gl.deleteTexture(texture.location);\r\n            texture.location = undefined;\r\n        }\r\n    },\r\n\r\n\r\n    updateProgram: function(program) {\r\n        const gl = this._gl;\r\n\r\n        if(!program.location) {\r\n            program.location = gl.createProgram();\r\n\r\n            this.updateShader(program.vertex);\r\n            gl.attachShader(program.location, program.vertex.location);\r\n\r\n            this.updateShader(program.fragment)\r\n            gl.attachShader(program.location, program.fragment.location);\r\n            \r\n            gl.linkProgram(program.location);\r\n            \r\n            this.deleteShader(program.vertex);\r\n            this.deleteShader(program.fragment);\r\n\r\n            if (!gl.getProgramParameter(program.location, gl.LINK_STATUS)) {\r\n                throw new Error(\"Could not initialise shaders\");\r\n            }\r\n        }\r\n        \r\n        gl.useProgram(program.location);\r\n        \r\n        this.context.bound.program = program;\r\n\r\n        if(program.needsUpdate) {\r\n            program.update();\r\n            program.needsUpdate = false;\r\n        }\r\n\r\n        for(let i=0; i<program.attributes.length; i++) {\r\n            this.updateAttribute(program.attributes[i], program.stride);\r\n        }\r\n\r\n        for(let i=0; i<program.uniforms.length; i++) {\r\n            this.updateUniform(program.uniformBuffer, program.uniforms[i]);\r\n        }\r\n    },\r\n\r\n    deleteProgram: function(program) {\r\n        const gl = this._gl;\r\n\r\n        if(program.location) {\r\n            gl.deleteProgram(program.location);\r\n        }\r\n    },\r\n\r\n    updateShader: function(shader) {\r\n        const gl = this._gl;\r\n\r\n        if(!shader.location) {\r\n            shader.location = gl.createShader(gl[shader.type]);\r\n        }\r\n\r\n        gl.shaderSource(shader.location, shader.source);\r\n        gl.compileShader(shader.location);\r\n\r\n        if (!gl.getShaderParameter(shader.location, gl.COMPILE_STATUS)) {\r\n            throw new Error(gl.getShaderInfoLog(shader.location));\r\n        }\r\n    },\r\n\r\n    deleteShader: function(shader) {\r\n        const gl = this._gl;\r\n\r\n        if(shader.location) {\r\n            gl.deleteShader(shader.location);\r\n            shader.location = undefined;\r\n        }\r\n    },\r\n\r\n    updateAttribute: function(attribute, stride) {\r\n        const gl = this._gl;\r\n        const a = attribute;\r\n\r\n        if(!a.location) {\r\n            a.location = gl.getAttribLocation(this.context.bound.program.location, a.name);\r\n\r\n            if(a.location < 0) {\r\n                throw new Error(\"attribute \" + a.name + \" undefined.\");\r\n            }\r\n        \r\n            gl.enableVertexAttribArray(a.location);\r\n        }\r\n\r\n        gl.vertexAttribPointer(a.location, a.size, gl[a.format], gl.FALSE, stride, a.offset);\r\n    },\r\n\r\n    updateUniform: function(buffer, uniform) {\r\n        const gl = this._gl;\r\n\r\n        if(!uniform.location) {\r\n            uniform.location = gl.getUniformLocation(this.context.bound.program.location, uniform.name);\r\n        }\r\n\r\n        switch(uniform.name) {\r\n            case Uniform.Binding.ModelView:\r\n                gl.uniformMatrix4fv(uniform.location, false, bound.model.matrix.local.data);\r\n            break;\r\n            case Uniform.Binding.Projection:\r\n                gl.uniformMatrix4fv(uniform.location, false, bound.camera.matrix.projection.data);\r\n            break;\r\n            default:\r\n                if(uniform.valueObject.value instanceof Texture) {\r\n                    this.updateTexture(uniform.valueObject.value, uniform.textureUnit);\r\n                    gl.uniform1i(uniform.location, uniform.textureUnit);\r\n                }\r\n                else {\r\n                    switch(uniform.shaderVarFormat) {\r\n                        case ShaderVarFormat.Int:\r\n                        gl.uniform1i(uniform.location, uniform.valueObject.value);\r\n                        break;\r\n        \r\n                        case ShaderVarFormat.Float:\r\n                        gl.uniform1f(uniform.location, uniform.valueObject.value);\r\n                        break;\r\n        \r\n                        case ShaderVarFormat.Vector2:\r\n                        gl.uniform2fv(uniform.location, uniform.valueObject.value.data);\r\n                        break;\r\n        \r\n                        case ShaderVarFormat.Vector3:\r\n                        gl.uniform3fv(uniform.location, uniform.valueObject.value.data);\r\n                        break;\r\n        \r\n                        case ShaderVarFormat.Vector4:\r\n                        gl.uniform4fv(uniform.location, uniform.valueObject.value.data);\r\n                        break;\r\n        \r\n                        case ShaderVarFormat.Matrix3:\r\n                        gl.uniformMatrix3fv(uniform.location, uniform.valueObject.value.data);\r\n                        break;\r\n                        \r\n                        case ShaderVarFormat.Matrix4:\r\n                        gl.uniformMatrix4fv(uniform.location, uniform.valueObject.value.data);\r\n                        break;\r\n                    }\r\n                }\r\n        }\r\n\r\n    },\r\n\r\n\r\n    updateBuffer: function(buffer) {\r\n\r\n        const gl = this._gl;\r\n\r\n        if(!buffer.location) {\r\n            buffer.location = gl.createBuffer();\r\n        }\r\n\r\n        let target;\r\n\r\n        if(buffer.bufferType !== Buffer.Type.Index) {\r\n            target = gl.ARRAY_BUFFER;\r\n        }\r\n        else {\r\n            target = gl.ELEMENT_ARRAY_BUFFER;\r\n        }\r\n\r\n        gl.bindBuffer(target, buffer.location);\r\n\r\n        if(buffer.needsUpdate) {\r\n            gl.bufferData(target, buffer.data, gl[buffer.usage]);\r\n            buffer.needsUpdate = false;\r\n        }\r\n    },\r\n\r\n\r\n    updateSceneContext: function(sceneContext) {\r\n        if(this.context.bound.sceneContext === sceneContext) return;\r\n\r\n        const gl = this._gl;\r\n\r\n        if(this.context.test.depth != sceneContext.test.depth) {\r\n            sceneContext.test.depth ? gl.enable(gl.DEPTH_TEST) : gl.disable(gl.DEPTH_TEST);\r\n            this.context.test.depth = sceneContext.test.depth;\r\n        }\r\n\r\n        if(this.context.test.stencil != sceneContext.test.stencil) {\r\n            sceneContext.test.stencil ? gl.enable(gl.STENCIL_TEST) : gl.disable(gl.STENCIL_TEST);\r\n            this.context.test.stencil = sceneContext.test.stencil;\r\n        }\r\n\r\n        this.context.bound.sceneContext = sceneContext;\r\n    },\r\n\r\n\r\n    updateCamera: function(camera) {\r\n        this.context.bound.camera = camera;\r\n\r\n        const v = camera.viewport;\r\n\r\n        if(!this.context.bound.viewport.equals(v)) {\r\n            this.context.bound.viewport.set(v.x, v.y, v.z, v.w);\r\n            this._gl.viewport(v.x, v.y, v.width, v.height);\r\n        }\r\n    },\r\n\r\n\r\n    clear: function(sceneContext) {\r\n        const gl = this._gl;\r\n\r\n        const c = sceneContext;\r\n        let bits = 0;\r\n\r\n        if(c.clear.color) {\r\n            gl.clearColor(c.color.r, c.color.g, c.color.b, c.color.a);\r\n            bits |= gl.COLOR_BUFFER_BIT;\r\n        }\r\n\r\n        if(c.clear.depth) {\r\n            bits |= gl.DEPTH_BUFFER_BIT;\r\n        }\r\n\r\n        if(c.clear.stencil) {\r\n            bits |= gl.STENCIL_BUFFER_BIT;\r\n        }\r\n\r\n        gl.clear(bits);\r\n    },\r\n\r\n\r\n    renderModel: function(model) {\r\n        this.context.bound.model = model;\r\n\r\n        if(model.scene) {\r\n            this.updateSceneContext(model.scene.context);\r\n        }\r\n\r\n        this.updateCamera(model.scene.camera);\r\n\r\n        this.renderMesh(model.mesh);\r\n    },\r\n\r\n\r\n    renderMesh: function(mesh, mat) {\r\n        const gl = this._gl;\r\n\r\n        this.updateBuffer(mesh.vertexBuffer);\r\n        this.updateProgram(mesh.material.program);\r\n\r\n        let bf = mesh.indexBuffer;\r\n\r\n        this.updateBuffer(bf);\r\n        gl.drawElements(gl[bf.drawMode], bf.limit, gl[bf.format], 0);\r\n    }\r\n}\r\n","import {Program, Uniform} from './assets/Program'\r\nimport {Texture} from './assets/Texture'\r\n\r\nexport class Material {\r\n    constructor(option) {\r\n        \r\n        this.program = new Program();\r\n        this.program.vertex.updateSource(option.vertexShader);\r\n        this.program.fragment.updateSource(option.fragmentShader);\r\n\r\n        this.uniforms = option.uniforms;\r\n\r\n        if(this.uniforms) {\r\n            let textureCount = -1;\r\n            Object.keys(this.uniforms).forEach((key) => {\r\n                let o = this.uniforms[key];\r\n                if(o.value instanceof Texture) {\r\n                    this.program.addUniform(new Uniform(key, o, ++textureCount));\r\n                }\r\n                else {\r\n                    this.program.addUniform(new Uniform(key, o));\r\n                }\r\n            });\r\n        }\r\n    }\r\n}","import {EventDispatcher} from '../../core/EventDispatcher'\r\nimport {Buffer, VarFormat, IndexBuffer} from './assets/Buffer'\r\n\r\nexport class Mesh extends EventDispatcher {\r\n    constructor() {\r\n        super();\r\n\r\n        this.vertexBuffer = new Buffer(VarFormat.Float, Buffer.Type.Interleaved, Buffer.Usage.Static);\r\n        this.indexBuffer = new IndexBuffer(IndexBuffer.DrawMode.Triangles);\r\n    }\r\n}","import {EventDispatcher} from '../../../core/EventDispatcher'\r\n\r\nexport class Asset extends EventDispatcher {\r\n    constructor() {\r\n        super();\r\n\r\n        this.needsUpdate = true;\r\n\r\n        this.location = undefined;\r\n    }\r\n}","import {Asset} from './Asset'\r\n\r\n\r\nexport const VarFormat = {\r\n    Byte : \"BYTE\",\r\n    UnsignedByte : \"UNSIGNED_BYTE\",\r\n    Short : \"SHORT\",\r\n    UnsignedShort : \"UNSIGNED_SHORT\",\r\n    Int : \"INT\",\r\n    UnsignedInt : \"UNSIGNED_INT\",\r\n    Float : \"FLOAT\",\r\n}\r\n\r\nconst getTypedArrayByFormat = (format, length) => {\r\n    switch(format) {\r\n        case VarFormat.Byte:    return new Int8Array(length);\r\n        case VarFormat.UnsignedByte:    return new Uint8Array(length);\r\n        case VarFormat.Short:    return new Int16Array(length);\r\n        case VarFormat.UnsignedShort:    return new Uint16Array(length);\r\n        case VarFormat.Int:    return new Int32Array(length);\r\n        case VarFormat.UnsignedInt:    return new Uint32Array(length);\r\n        case VarFormat.Float:    return new Float32Array(length);\r\n    }\r\n    return undefined;\r\n}\r\n\r\nexport class Buffer extends Asset {\r\n    constructor(format, bufferType, usage) {\r\n        super();\r\n\r\n        this.format = format;\r\n        this.bufferType = bufferType;\r\n        this.usage = usage;\r\n\r\n        this.data = getTypedArrayByFormat(this.format, 1);\r\n    }\r\n\r\n    clear() {\r\n        this.position = 0;\r\n        this.limit = 0;\r\n        this.needsUpdate = true;\r\n    }\r\n\r\n    allocate(length) {\r\n        if(this.data.length < length) {\r\n            this.extend(length);\r\n        }\r\n        this.clear();\r\n    }\r\n\r\n    get(offset, length=1) {\r\n        return this.data.subarray(offset, length);\r\n    }\r\n\r\n    put(original) {\r\n        \r\n        if(original instanceof Array || original instanceof Float32Array) {\r\n            this.data.set(original, this.position);\r\n            this.position += original.length;\r\n        }\r\n        else {\r\n            this.data[this.position] = original;\r\n            this.position += 1;\r\n        }\r\n\r\n        this.limit = this.position;\r\n\r\n        this.needsUpdate = true;\r\n    }\r\n\r\n    update(original, offset) {\r\n        if(original instanceof Array || original instanceof Float32Array) {\r\n            this.data.set(original, offset);\r\n        }\r\n        else {\r\n            this.data[offset] = original;\r\n        }\r\n\r\n        this.needsUpdate = true;\r\n    }\r\n\r\n    extend(length) {\r\n        const tmp = this.data;\r\n        let v = tmp.length;\r\n        while(v < length) {\r\n            v *= 2;\r\n        }\r\n        this.data = getTypedArrayByFormat(this.format, v);\r\n        this.data.set(tmp);\r\n    }\r\n}\r\n\r\nBuffer.Usage = {\r\n    Static : \"STATIC_DRAW\",\r\n    Dynamic : \"DYNAMIC_DRAW\",\r\n    Stream : \"STREAM_DRAW\"\r\n}\r\n\r\nBuffer.Type = {\r\n    Interleaved : \"Interleaved\",\r\n    Index : \"Index\"\r\n}\r\n\r\nexport class IndexBuffer extends Buffer {\r\n    constructor(drawMode) {\r\n        super(VarFormat.UnsignedShort, Buffer.Type.Index, Buffer.Usage.Static);\r\n\r\n        this.drawMode = drawMode;\r\n    }\r\n}\r\n\r\nIndexBuffer.DrawMode = {\r\n    Triangles:\"TRIANGLES\"\r\n}","import {Asset} from './Asset'\r\nimport {Buffer, VarFormat} from './Buffer'\r\nimport {Texture} from './Texture'\r\nimport {Matrix3, Matrix4} from '../../../geom/Matrix'\r\nimport { Vec2, Vec3, Vec4 } from '../../../geom/Vec';\r\n\r\n\r\nexport const ShaderVarFormat = {\r\n    Int:\"Int\",\r\n    Float:\"Float\",\r\n    Vector2:\"Vector2\",\r\n    Vector3:\"Vector3\",\r\n    Vector4:\"Vector4\",\r\n    Matrix3:\"Matrix3\",\r\n    Matrix4:\"Matrix4\"\r\n}\r\n\r\nconst getSizeFromShaderVarFormat = format => {\r\n    switch(format) {\r\n        case ShaderVarFormat.Int:\r\n        case ShaderVarFormat.Float:\r\n            return 1;\r\n        case ShaderVarFormat.Vector2:\r\n            return 2;\r\n        case ShaderVarFormat.Vector3:\r\n            return 3;\r\n        case ShaderVarFormat.Vector4:\r\n            return 4;\r\n        case ShaderVarFormat.Matrix3:\r\n            return 9;\r\n        case ShaderVarFormat.Matrix4:\r\n            return 16;\r\n        default:\r\n            return 0;\r\n            \r\n    }\r\n}\r\n\r\n\r\nexport class ShaderVar extends Asset {\r\n    constructor(name, varFormat, shaderVarFormat) {\r\n        super();\r\n\r\n        this.name = name;\r\n        this.format = varFormat;\r\n        this.shaderVarFormat = shaderVarFormat;\r\n\r\n        this.offset = 0;\r\n        this.size = getSizeFromShaderVarFormat(shaderVarFormat);\r\n    }\r\n}\r\n\r\n\r\nexport class Uniform extends ShaderVar {\r\n    constructor(name, valueObject, textureUnit=-1) {\r\n\r\n        let varFormat;\r\n        let shaderVarFormat;\r\n\r\n        if(valueObject) {\r\n            varFormat = VarFormat.Float;\r\n\r\n            switch(valueObject.value.constructor) {\r\n                case Texture:\r\n                    varFormat = VarFormat.Int;\r\n                    shaderVarFormat = ShaderVarFormat.Int;\r\n                    break;\r\n                case Matrix3:\r\n                    shaderVarFormat = ShaderVarFormat.Matrix3;\r\n                    break;\r\n                case Matrix4:\r\n                    shaderVarFormat = ShaderVarFormat.Matrix4;\r\n                    break;\r\n                case Vec2:\r\n                    shaderVarFormat = ShaderVarFormat.Vector2;\r\n                    break;\r\n                case Vec3:\r\n                    shaderVarFormat = ShaderVarFormat.Vector3;\r\n                    break;\r\n                case Vec4:\r\n                    shaderVarFormat = ShaderVarFormat.Vector4;\r\n                    break;\r\n                default:\r\n                    shaderVarFormat = ShaderVarFormat.Float;\r\n            }\r\n        }\r\n\r\n        super(name, varFormat, shaderVarFormat);\r\n\r\n        this.valueObject = valueObject;\r\n        this.textureUnit = textureUnit;\r\n    }\r\n}\r\n\r\n\r\nUniform.Binding = {\r\n    Projection: \"projectionMatrix\",\r\n    ModelView: \"modelViewMatrix\"\r\n}\r\n\r\n\r\nexport class Shader extends Asset {\r\n    constructor(type) {\r\n        super();\r\n\r\n        this.type = type;\r\n    }\r\n\r\n    updateSource(source) {\r\n        this.source = source;\r\n    }\r\n}\r\n\r\nShader.VERTEX = \"VERTEX_SHADER\";\r\nShader.FRAGMENT = \"FRAGMENT_SHADER\";\r\n\r\nexport class Program extends Asset {\r\n    constructor() {\r\n        super();\r\n\r\n        this.vertex = new Shader(Shader.VERTEX);\r\n        this.fragment = new Shader(Shader.FRAGMENT);\r\n\r\n        this.attributes = [];\r\n        this.uniforms = [];\r\n\r\n        this.stride = 0;\r\n\r\n        // this.uniformBuffer = new Buffer(VarFormat.Float, Buffer.Type.Interleaved, Buffer.Usage.Static);\r\n        // this.uniformBuffserSize = 0;\r\n    }\r\n\r\n    addAttribute(attribute) {\r\n        this.attributes.push(attribute);\r\n        this.needsUpdate = true;\r\n    }\r\n\r\n    addUniform(uniform) {\r\n        this.uniforms.push(uniform);\r\n        this.needsUpdate = true;\r\n    }\r\n\r\n    update() {\r\n        this.stride = 0;\r\n\r\n        const bytes_per_float = 4;\r\n\r\n        for(let i=0; i<this.attributes.length; i++) {\r\n            let a = this.attributes[i];\r\n            a.offset = this.stride;\r\n            this.stride += bytes_per_float * a.size;\r\n        }\r\n\r\n        // this.uniformBuffserSize = 0;\r\n        // for(let i=0; i<this.uniforms.length; i++) {\r\n        //     let u = this.uniforms[i];\r\n        //     u.offset = this.uniformBuffserSize;\r\n        //     this.uniformBufferSize += bytes_per_float * u.size;\r\n        // }\r\n\r\n        // this.uniformBuffer.allocate(this.uniformBufferSize);\r\n    }\r\n}","import {Asset} from './Asset'\r\n\r\nexport class Texture extends Asset {\r\n    constructor(src) {\r\n        super();\r\n\r\n        this.image = undefined;\r\n\r\n        if(src) {\r\n            this.setup(src);\r\n        }\r\n    }\r\n\r\n    setup(src) {\r\n        if(!this.image) {\r\n            this.image = new Image();\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            if(this.image.src != src) {\r\n                this.needsUpdate = false;\r\n                this.image.src = src;\r\n                this.image.onload = () => {\r\n                    this.needsUpdate = true;\r\n                    resolve();\r\n                }\r\n            }\r\n            else {\r\n                resolve();\r\n            }\r\n        });\r\n    }\r\n}","import {EventDispatcher} from '../../../core/EventDispatcher'\r\nimport {Mesh} from '../Mesh'\r\nimport {Vec4} from '../../../geom/Vec'\r\n// import {Matrix3, Matrix4} from '../../../geom/Matrix'\r\n\r\nexport class Node extends EventDispatcher {\r\n    constructor() {\r\n        super();\r\n\r\n        this.children = [];\r\n\r\n        this.matrix = {}\r\n    }\r\n\r\n    addChild(node) {\r\n        this.children.push(node);\r\n        node.parent = this;\r\n    }\r\n\r\n    removeChild(node) {\r\n        node.parent = undefined;\r\n\r\n        var index = this.children.indexOf(node);\r\n        if (index > -1) {\r\n            this.children.splice(index, 1);\r\n        }\r\n    }\r\n}\r\n\r\n// export class Node2D extends Node {\r\n//     constructor() {\r\n//         super();\r\n\r\n//         this.matrix.local = new Matrix3();\r\n//     }\r\n// }\r\n\r\n// export class Node3D extends Node {\r\n//     constructor() {\r\n//         super();\r\n\r\n//         this.matrix.local = new Matrix4();\r\n//     }\r\n// }\r\n\r\nexport class Model extends Node {\r\n    constructor() {\r\n        super();\r\n\r\n        this.mesh = new Mesh();\r\n    }\r\n}\r\n\r\nexport class Camera extends Node {\r\n    constructor() {\r\n        super();\r\n\r\n        this.viewport = new Vec4();\r\n\r\n        // this.matrix.projection = new Matrix4();\r\n        // this.matrix.view = new Matrix4();\r\n        // this.matrix.viewProjection = new Matrix4();\r\n    }\r\n\r\n    // perspective(fov, aspect, near, far) {\r\n    //     this.matrix.projection.perspective(fov, aspect, near, far);\r\n    // }\r\n\r\n    setViewport(x, y, width, height) {\r\n        this.viewport.set(x, y, width, height);\r\n        // this.perspective(60, width/height, 0.1, 100);\r\n    }\r\n}","import {Color} from '../../../geom/Color'\r\nimport {Node, Camera} from './Node'\r\n\r\n\r\nexport class SceneContext {\r\n    constructor() {\r\n        this.clear = {\r\n            color: true,\r\n            depth: false,\r\n            stencil: false\r\n        }\r\n\r\n        this.test = {\r\n            depth: false,\r\n            stencil: false\r\n        }\r\n\r\n        this.color = new Color();\r\n    }\r\n}\r\n\r\nexport class Scene3D extends Node {\r\n    constructor() {\r\n        super();\r\n\r\n        this.context = new SceneContext();\r\n\r\n        this.camera = new Camera();\r\n    }\r\n\r\n    addChild(node) {\r\n        \r\n        if(node.parent) {\r\n            node.parent.removeChild(node);\r\n        }\r\n\r\n        super.addChild(node);\r\n\r\n        node.scene = this;\r\n    }\r\n\r\n    removeChild(node) {\r\n        super.removeChild(node);\r\n\r\n        node.scene = undefined;\r\n    }\r\n}","import {EventDispatcher} from './EventDispatcher'\r\n\r\nclass Environment extends EventDispatcher {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tconsole.info(\"xslider ver.\",XSLIDER_VERSION);\r\n\t\t// if(!THREE) {\r\n\t\t// \tconsole.error(\"xslider depend on three.js\");\r\n\t\t// }\r\n\t\t// if(!domtoimage) {\r\n\t\t// \tconsole.error(\"xslider depend on dom-to-image\");\r\n\t\t// }\r\n\t}\r\n\r\n\tget support() {\r\n\t\treturn Environment.support;\r\n\t}\r\n}\r\n\r\nEnvironment.support = {\r\n\ttouch : ('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch,\r\n\tpointer : window.navigator.pointerEnabled,\r\n\tMSPointer : window.navigator.msPointerEnabled\r\n};\r\n\r\nexport const env = new Environment();","import {env} from './Environment'\r\n\r\nexport const Event = {\r\n\tCHANGE : 'change',\r\n};\r\n\r\nconst types = [];\r\nif(env.support.touch) {\r\n\ttypes.push('touchstart','touchmove','touchend');\r\n}\r\nelse if(env.support.pointer) {\r\n\ttypes.push('pointerdown','pointermove','pointerup');\r\n}\r\nelse if(env.support.MSPointer) {\r\n\ttypes.push('MSPointerDown','MSPointerMove','MSPointerUp');\r\n}\r\nelse {\r\n\ttypes.push('mousedown','mousemove','mouseup');\r\n}\r\n\r\nexport const TouchEvent = {\r\n\tSTART : types[0],\r\n\tMOVE : types[1],\r\n\tEND : types[2],\r\n};\r\n","\r\n\r\n\r\n\r\nexport class EventDispatcher {\r\n\r\n\tconstructor() {\r\n\t\tthis._listeners = {};\r\n\t\tthis._properties = {};\r\n\t}\r\n\r\n\tget listeners() {\r\n\t\treturn this._listeners;\r\n\t}\r\n\r\n\tget(key) {\r\n\t\treturn this._properties[key];\r\n\t}\r\n\r\n\tset(properties) {\r\n\t\tif (!properties) return;\r\n\r\n\t\tfor (let key in properties) {\r\n\r\n\t\t\tif ((this._properties[key] === undefined && properties[key] !== undefined) || this._properties[key] !== properties[key]) {\r\n\t\t\t\tlet v0 = this._properties[key];\r\n\t\t\t\tthis._properties[key] = properties[key];\r\n\r\n\t\t\t\tthis.dispatch(key, {\r\n\t\t\t\t\ttype: key,\r\n\t\t\t\t\tvalue: this._properties[key],\r\n\t\t\t\t\tvalue0: v0\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tdispatch(type, options) {\r\n\t\tif (this._listeners.hasOwnProperty(type)) {\r\n\t\t\tthis._listeners[type].forEach(o => {\r\n\t\t\t\tlet tmp = options || { type: type };\r\n\t\t\t\to.listener(tmp);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\ton(type, listener) {\r\n\r\n\t\tthis.off(type, listener);\r\n\r\n\t\tif (!this._listeners.hasOwnProperty(type)) {\r\n\t\t\tthis._listeners[type] = [];\r\n\t\t}\r\n\r\n\t\tthis._listeners[type].push({ type: type, listener: listener });\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\toff(type, listener) {\r\n\t\tif (type) {\r\n\t\t\tif (!listener) {\r\n\t\t\t\tdelete this._listeners[type];\r\n\t\t\t}\r\n\t\t\telse if (this._listeners.hasOwnProperty(type)) {\r\n\t\t\t\tthis._listeners[type].some((elem, i) => {\r\n\t\t\t\t\tif (elem.listener == listener) this._listeners[type].splice(i, 1);\r\n\t\t\t\t});\r\n\t\t\t\tif (this._listeners[type].length == 0) {\r\n\t\t\t\t\tdelete this._listeners[type];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfor (let type in this._listeners) {\r\n\t\t\t\tdelete this._listeners[type];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n};\r\n","import {env} from './Environment'\r\nimport {Event, TouchEvent} from './Event'\r\nimport {EventDispatcher} from './EventDispatcher'\r\n\r\nexport class InteractiveObject extends EventDispatcher {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis._defineHandlers();\r\n\r\n\t\tthis.on('target', this._on.changeTarget);\r\n\t}\r\n\r\n\r\n\t_defineHandlers() {\r\n\r\n\t\tthis._on = {\r\n\t\t\tbubble : (e) => {\r\n\t\t\t\tthis.dispatch(e.type, e);\r\n\t\t\t},\r\n\r\n\t\t\tchangeTarget : (o) => {\r\n\t\t\t\tif(o.value0) {\r\n\t\t\t\t\tfor(let type in this._listeners) {\r\n\t\t\t\t\t\tthis._autoRemoveListener(o.value0, type);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.off();\r\n\t\t\t},\r\n\r\n\t\t\ttouch : (e) => {\r\n\r\n\t\t\t\tif(env.support.touch) {\r\n\t\t\t\t\tlet touch = e.touches[0]\r\n\t\t\t\t\tif(touch) {\r\n\t\t\t\t\t\te.clientX = touch.clientX;\r\n\t\t\t\t\t\te.clientY = touch.clientY;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\te.clientX = this.clientX0;\r\n\t\t\t\t\t\te.clientY = this.clientY0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!this.clientX0) {\r\n\t\t\t\t\tthis.clientX0 = e.clientX;\r\n\t\t\t\t\tthis.clientY0 = e.clientY;\r\n\t\t\t\t}\r\n\r\n\t\t\t\te.clientX0 = this.clientX0;\r\n\t\t\t\te.clientY0 = this.clientY0;\r\n\r\n\t\t\t\tthis.clientX0 = e.clientX;\r\n\t\t\t\tthis.clientY0 = e.clientY;\r\n\r\n\t\t\t\tthis.dispatch(e.type, e);\r\n\t\t\t},\r\n\r\n\t\t\ttouchStart : (e) => {\r\n\t\t\t\tthis.clientX0 = this.clientY0 = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tdispose() {\r\n\t\tthis.off();\r\n\t}\r\n\r\n\r\n\ton(type, listener, options) {\r\n\r\n\t\tsuper.on(type, listener, options);\r\n\r\n\t\tconst target = this.get('target');\r\n\t\tthis._autoAddListener(target, type);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\toff(type, listener) {\r\n\r\n\t\tsuper.off(type, listener);\r\n\r\n\t\tconst target = this.get('target');\r\n\t\tthis._autoRemoveListener(target, type);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\t_autoAddListener(target, type) {\r\n\r\n\t\tif(!target) return;\r\n\r\n\t\tif(this._listeners[type].length == 1) {\r\n\t\t\tswitch(type) {\r\n\t\t\t\tcase TouchEvent.START:\r\n\t\t\t\tcase TouchEvent.MOVE:\r\n\t\t\t\tcase TouchEvent.END:\r\n\t\t\t\t\ttarget.addEventListener(type, this._on.touch);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'click':\r\n\t\t\t\t\ttarget.addEventListener(type, this._on.bubble);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif(type == TouchEvent.MOVE) {\r\n\t\t\t\ttarget.addEventListener(TouchEvent.START, this._on.touchStart);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t_autoRemoveListener(target, type) {\r\n\r\n\t\tif(!target) return;\r\n\r\n\t\tif(!this._listeners[type] || this._listeners[type].length == 0) {\r\n\t\t\tswitch(type) {\r\n\t\t\t\tcase TouchEvent.START:\r\n\t\t\t\tcase TouchEvent.MOVE:\r\n\t\t\t\tcase TouchEvent.END:\r\n\t\t\t\t\ttarget.removeEventListener(type, this._on.touch);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'click':\r\n\t\t\t\t\ttarget.removeEventListener(type, this._on.bubble);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif(type == TouchEvent.MOVE) {\r\n\t\t\t\ttarget.removeEventListener(TouchEvent.START, this._on.touchStart);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import {Event, TouchEvent} from '../core/Event'\r\nimport {InteractiveObject} from '../core/InteractiveObject'\r\nimport {env} from '../core/Environment'\r\nimport {Ticker} from './Ticker'\r\n\r\nclass Stage extends InteractiveObject {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.ticker = new Ticker();\r\n\r\n\t\tthis.set({target:window});\r\n\t}\r\n\r\n\tready() {\r\n\t\treturn new Promise((resolve,reject) => {\r\n\r\n\t\t\tconst loaded = () => {\r\n\t\t\t    document.removeEventListener('DOMContentLoaded', loaded), \r\n\t\t\t    window.removeEventListener('load', loaded);\r\n\r\n\t\t\t    resolve();\r\n\t\t\t};\r\n\r\n\t\t\tif(document.readyState === 'complete') {\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdocument.addEventListener('DOMContentLoaded', loaded), \r\n\t\t\t\twindow.addEventListener('load', loaded);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tget width() {\r\n\t\treturn (window.innerWidth || document.documentElement.clientWidth || 0);\r\n\t}\r\n\r\n\tget height() {\r\n\t\treturn (window.innerHeight || document.documentElement.clientHeight || 0);\r\n\t}\r\n\r\n\t_autoAddListener(target, type) {\r\n\r\n\t\tif(!target) return;\r\n\r\n\t\tsuper._autoAddListener(target, type);\r\n\r\n\t\tif(this._listeners[type].length == 1) {\r\n\t\t\tswitch(type) {\r\n\t\t\t\tcase 'tick':\r\n\t\t\t\t\tthis.ticker.on(type, this._on.bubble);\r\n\t\t\t\t\tthis.ticker.start();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'resize':\r\n\t\t\t\t\ttarget.addEventListener(type, this._on.bubble);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t_autoRemoveListener(target, type) {\r\n\r\n\t\tif(!target) return;\r\n\r\n\t\tsuper._autoRemoveListener(target, type);\r\n\r\n\t\tif(!this._listeners[type] || this._listeners[type].length == 0) {\r\n\t\t\tswitch(type) {\r\n\t\t\t\tcase 'tick':\r\n\t\t\t\t\tthis.ticker.off(type, this._on.bubble);\r\n\t\t\t\t\tthis.ticker.stop();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'resize':\r\n\t\t\t\t\ttarget.removeEventListener(type, this._on.bubble);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\t\r\n}\r\n\r\n//singleton\r\nexport const stage = new Stage;\r\n\r\n","import {EventDispatcher} from '../core/EventDispatcher';\r\n\r\nexport const Ticker = class extends EventDispatcher {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.fps = 30;\r\n\r\n\t\tthis._defineFunctions();\r\n\t}\r\n\r\n\t_defineFunctions() {\r\n\r\n\t\tconst prefixes = [\"ms\",\"moz\",\"webkit\",\"o\"];\r\n\t\tlet i = prefixes.length;\r\n\r\n\t\twhile (--i > -1 && !window.requestAnimationFrame) {\r\n\t\t\twindow.requestAnimationFrame = window[prefixes[i] + \"RequestAnimationFrame\"];\r\n\t\t\twindow.cancelAnimationFrame = window[prefixes[i] + \"CancelAnimationFrame\"] || window[prefixes[i] + \"CancelRequestAnimationFrame\"];\r\n\t\t}\r\n\r\n\r\n\t\tthis._tickHandler = () => {\r\n\t\t\tthis._requestId = window.requestAnimationFrame(this._tickHandler);\r\n\r\n\t\t\tthis._lastMs = this.time;\r\n\r\n\t\t\tlet overlap = this._lastMs - this._nextMs;\r\n\r\n\t\t\tif(overlap >= 0) {\r\n\t\t\t\tconst t0 = this._nextMs;\r\n\t\t\t\tthis._nextMs += overlap + (overlap >= this._gap ? 1 : this._gap - overlap);\r\n\t\t\t\tthis.dispatch('tick', {type:'tick', time:this._lastMs - this._startMs, dt:this._nextMs-t0});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget fps() {\r\n\t\treturn this._fps;\r\n\t}\r\n\r\n\tset fps(v) {\r\n\t\tthis._fps = v;\r\n\t\tthis._gap = 1 / (v || 60) * 1000;\r\n\t}\r\n\r\n\tget time() {\r\n\t\treturn Date.now() || new Date().getTime();\r\n\t}\r\n\r\n\tstart() {\r\n\t\tthis._startMs = this.time;\r\n\t\tthis._nextMs = this._startMs + this._gap;\r\n\t\tthis._requestId = window.requestAnimationFrame(this._tickHandler);\r\n\t}\r\n\r\n\tstop() {\r\n\t\twindow.cancelAnimationFrame(this._requestId);\r\n\t}\r\n}\r\n\r\nexport const TweenMaxTicker = class extends Ticker {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tsetFps() {\r\n\t\t\r\n\t}\r\n\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tstop() {\r\n\r\n\t}\r\n}","import {InteractiveObject} from '../core/InteractiveObject'\r\n\r\nexport class Button extends InteractiveObject {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tsetup(dom) {\r\n\t\tthis.set({target:dom});\r\n\t}\r\n\r\n\tset active(flag) {\r\n\t\tconst target = this.get('target');\r\n\t\tif(flag) {\r\n\t\t\ttarget.classList.remove(\"xslider-disabled\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttarget.classList.add(\"xslider-disabled\");\r\n\t\t}\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis.active = true;\r\n\t}\r\n}","import {EventDispatcher} from '../core/EventDispatcher'\r\nimport {stage} from '../core/Stage'\r\nexport class Dom extends EventDispatcher {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis._defineHandlers();\r\n\r\n\t\t// this.canvas = document.createElement('canvas');\r\n\t}\r\n\r\n\t_defineHandlers() {\r\n\t\tthis._onResize = (e) => {\r\n\t\t\tif(this._width != this.width || this._height != this.height) {\r\n\t\t\t\tthis._width = this.width;\r\n\t\t\t\tthis._height = this.height;\r\n\t\t\t\tthis.dispatch('resize', {type:'resize', width:this._width, height:this._height});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget width() {\r\n\t\treturn this.container.clientWidth;\r\n\t}\r\n\r\n\tget height() {\r\n\t\treturn this.container.clientHeight;\r\n\t}\r\n\r\n\tsetup(selector) {\r\n\r\n\t\tthis.container = document.querySelector(selector);\r\n\t\tthis.container.classList.add(\"xslider-container\");\r\n\r\n\t\tthis.view = this.container.querySelector(\".xslider-view\");\r\n\t\tthis.slides = this.view.querySelectorAll(\".xslider-slide\");\r\n\r\n\t\tthis.pager = this.container.querySelector(\".xslider-pager\");\r\n\t\tthis.prev = this.container.querySelector(\".xslider-prev\");\r\n\t\tthis.next = this.container.querySelector(\".xslider-next\");\r\n\r\n\t\tstage.on('resize', this._onResize);\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis._width = this._height = undefined;\r\n\t\tstage.off('resize', this._onResize);\r\n\t\tthis.container.classList.remove(\"xslider-container\", \"xslider-debug\");\r\n\t}\r\n}","import {EventDispatcher} from '../core/EventDispatcher'\r\n\r\nexport class Pager extends EventDispatcher {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis._defineHandlers();\r\n\t}\r\n\r\n\t_defineHandlers() {\r\n\t\t\r\n\t\tthis._onClick = (e) => {\r\n\t\t\tconst index = this.list.indexOf(e.target);\r\n\t\t\tthis.set({index:index});\r\n\t\t}\r\n\r\n\t\tthis._onChangeIndex = (e) => {\r\n\t\t\tif(e.value0 !== undefined) {\r\n\t\t\t\tthis.list[e.value0].classList.remove(\"xslider-active\");\r\n\t\t\t}\r\n\r\n\t\t\tthis.list[e.value].classList.add(\"xslider-active\");\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tsetup(data) {\r\n\t\tthis.container = data.dom.pager;\r\n\t\tthis.list = [];\r\n\r\n\t\tconst length = data.dom.slides.length;\r\n\r\n\t\tfor(let i=0; i<length; i++) {\r\n\t\t\tlet span = document.createElement('span');\r\n\t\t\tthis.container.appendChild(span);\r\n\r\n\t\t\tspan.addEventListener('click', this._onClick);\r\n\t\t\tthis.list.push(span);\r\n\t\t}\r\n\r\n\t\tthis.on(\"index\", this._onChangeIndex);\r\n\t\tthis.set({index:data.option.initialSlideIndex});\r\n\t}\r\n\r\n\r\n\tdispose() {\r\n\t\tthis.off(\"index\", this._onChangeIndex);\r\n\t\tthis.set({index:undefined});\r\n\r\n\t\tthis.list.forEach((span) => {\r\n\t\t\tspan.removeEventListener('click', this._onClick);\r\n\t\t\tthis.container.removeChild(span);\r\n\t\t})\r\n\t}\r\n}","import {net} from '../components/Net'\r\nimport {cloner} from '../components/converter/Cloner'\r\nimport {Inliner} from '../components/converter/Inliner'\r\nimport {converter} from '../components/converter/SvgConverter'\r\n// import {Bench} from '../components/debug/Bench'\r\nimport {Option} from '../components/Option'\r\n\r\nimport {EventDispatcher} from '../core/EventDispatcher'\r\n\r\nexport class Slide {\r\n\r\n\tconstructor(slide, debug) {\r\n\t\tthis.element = slide;\r\n\t\tthis.debug = debug;\r\n\t\tthis.canvas = document.createElement('canvas');\r\n\t\tthis.image = new Image();\r\n\t\tthis.layer = {\r\n\t\t\t\"gl\" : slide.querySelector(\".xslider-layer-gl\")\r\n\t\t\t, \"ui\" : slide.querySelector(\".xslider-layer-ui\")\r\n\t\t}\r\n\r\n\t\tif(this.debug == Option.Debug.DISPLAY.IMG) {\r\n\t\t\tthis.element.insertBefore(this.image, this.layer.gl);\r\n\t\t}\r\n\r\n\t\t// this.element.insertBefore(this.canvas, this.layer.gl);\r\n\r\n\t\tthis.inlinedNode = undefined;\r\n\t\tthis.needsResize = false;\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis.layer.gl && this.layer.gl.classList.remove(\"xslider-capture\");\r\n\t}\r\n\r\n\tready() {\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\t//\r\n\t\t\tif(this.inlinedNode) {\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t\t//texture\r\n\t\t\telse if(!this.layer.gl) {\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tInliner.inlineNode(this.layer.gl).then(inlined => {\r\n\t\t\t\t\tthis.inlinedNode = inlined;\r\n\t\t\t\t\t\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// // Utils.toSvg(this.layer.gl)\r\n\t\t\t\t// converter.from(this.layer.gl)\r\n\t\t\t\t// \t.then((svg) => {\r\n\t\t\t\t// \t\tthis.svg = svg;\r\n\t\t\t\t// \t\tthis.layer.gl.classList.remove(\"xslider-capture\");\r\n\t\t\t\t// \t\tthis.needsResize = true;\r\n\t\t\t\t// \t\t// document.querySelector('#xslider').appendChild(this.svg.documentElement.cloneNode(true));\r\n\t\t\t\t// \t\tresolve();\r\n\t\t\t\t// \t});\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tloadSvg(w, h) {\r\n\r\n\t\tthis.svg = converter.convert(this.inlinedNode, w, h);\r\n\r\n\t\tlet string = new XMLSerializer().serializeToString(this.svg);\r\n\t\t// console.log('string', string)\r\n\t\t// string = string.replace(/#/g, '%23').replace(/\\n/g, '%0A')\r\n\t\tconst uri = \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(string);\r\n\r\n\t\tif(this.debug == Option.Debug.DISPLAY.SVG) {\r\n\r\n\t\t\tif(this._svg0 === undefined) {\r\n\t\t\t\tthis._svg0 = this.element.insertBefore(this.svg.childNodes[0], this.layer.gl);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst node = this.svg.childNodes[0];\r\n\t\t\t\tthis.element.replaceChild(node, this._svg0);\r\n\t\t\t\tthis._svg0 = node;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn net.loadImage(this.image, uri)\r\n\t}\r\n\r\n\r\n\tresize(w, h) {\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\tif(!this.needsResize) {\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.needsResize = false;\r\n\r\n\t\t\t\tthis.canvas.width = w;\r\n\t\t\t\tthis.canvas.height = h;\r\n\r\n\t\t\t\tif(this.layer.gl) {\r\n\t\t\t\t\tthis.layer.gl.classList.add(\"xslider-capture\");\r\n\t\r\n\t\t\t\t\tcloner.cloneStyle(this.layer.gl, this.inlinedNode, Slide.EXCLUDES);\r\n\t\r\n\t\t\t\t\tthis.layer.gl.classList.remove(\"xslider-capture\");\r\n\r\n\t\t\t\t\tthis.loadSvg(w, h).then(() => {\r\n\t\t\t\t\t\tconst c = this.canvas.getContext('2d');\r\n\t\t\t\t\t\tc.clearRect(0,0,w,h);\r\n\t\t\t\t\t\tc.drawImage(this.image,0,0,w,h);\r\n\t\t\t\t\t\t// console.log(this.image, w, h);\r\n\t\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nSlide.EXCLUDES = ['background', 'left', 'right', 'width', 'height'];\r\n\r\nexport class SlideContainer extends EventDispatcher {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis._defineHandlers();\r\n\r\n\t\tthis.width = this.height = -1;\r\n\t}\r\n\r\n\t_defineHandlers() {\r\n\t\tthis._onChangeSlide = (e) => {\r\n\t\t\t// console.log(e);\r\n\r\n\t\t\tlet removeOld = false;\r\n\r\n\t\t\tswitch(e.type) {\r\n\t\t\t\tcase 'slide0':\r\n\t\t\t\t\tthis.updateSlide(0);\r\n\t\t\t\t\tremoveOld = e.value0 !== undefined;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'slide1':\r\n\t\t\t\t\tthis.updateSlide(1);\r\n\t\t\t\t\tremoveOld = e.value0 !== undefined && e.value0 !== this.get('slide0');\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif(removeOld) {\r\n\t\t\t\te.value0.element.classList.remove(\"xslider-slide-active\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tready(indexer) {\r\n\t\tconst slide0 = indexer.data.list[indexer.i0]\r\n\t\tlet slide1 = undefined;\r\n\r\n\t\tconst arr = [\r\n\t\t\tslide0.ready()\r\n\t\t];\r\n\r\n\t\tif(indexer.i1 !== undefined) {\r\n\t\t\tslide1 = indexer.data.list[indexer.i1];\r\n\t\t\tarr.push(slide1.ready());\r\n\t\t}\r\n\r\n\t\treturn Promise.all(arr).then(() => {\r\n\t\t\tthis.set({ slide0:slide0, slide1:slide1 });\r\n\t\t});\r\n\t}\r\n\r\n\tsetup(mesh) {\r\n\t\tthis.mesh = mesh;\r\n\t\tif(this.mesh) {\r\n\t\t\tthis.uniforms = this.mesh.material.uniforms;\r\n\t\t}\r\n\r\n\t\tthis.on('slide0', this._onChangeSlide);\r\n\t\tthis.on('slide1', this._onChangeSlide);\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis.off('slide0', this._onChangeSlide);\r\n\t\tthis.off('slide1', this._onChangeSlide);\r\n\r\n\t\tconst slide0 = this.get('slide0');\r\n\t\tconst slide1 = this.get('slide1');\r\n\t\tslide0.element.classList.remove(\"xslider-slide-active\");\r\n\t\tslide1 && slide1.element.classList.remove(\"xslider-slide-active\");\r\n\t}\r\n\r\n\tresize(w, h) {\r\n\t\tthis.width = w; this.height = h;\r\n\r\n\t\tif(this.mesh) {\r\n\t\t\tthis.uniforms.resolution.value.set(w,h);\r\n\t\t}\r\n\r\n\t\treturn Promise.all([this.updateSlide(0), this.updateSlide(1)]);\r\n\t}\r\n\r\n\tupdateSlide(slideIndex) {\r\n\t\tif(this.width == -1 && this.height == -1)\treturn;\r\n\r\n\t\tconst slide = this.get('slide'+slideIndex);\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t// console.log(this.uniforms);\r\n\t\t\t// console.log(this.uniforms.texture0.value.image);\r\n\t\t\t// console.log(this.uniforms.texture1.value.image);\r\n\t\t\t// console.log(slide);\r\n\t\t\t// console.log(slideIndex, this.uniforms.texture0.value.image == this.uniforms.texture1.value.image);\r\n\r\n\t\t\tif(!slide)  {\r\n\t\t\t\tif(this.uniforms) {\r\n\t\t\t\t\tconst texture = this.uniforms['texture'+slideIndex].value;\r\n\t\t\t\t\ttexture.image = undefined;\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\t\t\t\t}\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\r\n\t\t\tslide.element.classList.add(\"xslider-slide-active\");\r\n\t\r\n\t\t\tslide.resize(this.width, this.height)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tif(this.uniforms) {\r\n\t\t\t\t\t\tconst texture = this.uniforms['texture'+slideIndex].value;\r\n\t\t\t\t\t\ttexture.image = slide.canvas;\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t});\r\n\t\t});\r\n\t}\r\n}","import {InteractiveObject} from '../core/InteractiveObject'\r\nimport {Button} from './Button'\r\nimport {Pager} from './Pager'\r\n\r\n\r\nexport class UI extends InteractiveObject {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\r\n\t_defineHandlers() {\r\n\t\tsuper._defineHandlers();\r\n\r\n\t\tthis._onPrev = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis.dispatch(UI.EVENT.PREV);\r\n\t\t}\r\n\r\n\t\tthis._onNext = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis.dispatch(UI.EVENT.NEXT);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tsetup(data) {\r\n\t\tconst dom = data.dom;\r\n\r\n\t\tthis.set({target:dom.view});\r\n\r\n\t\tif(dom.pager) {\r\n\t\t\tthis.pager = this.pager || new Pager();\r\n\t\t\tthis.pager.setup(data);\r\n\t\t\tthis.pager.on('index', this._on.bubble);\r\n\t\t}\r\n\r\n\t\tif(dom.prev) {\r\n\t\t\tthis.prev = this.prev || new Button();\r\n\t\t\tthis.prev.setup(dom.prev);\r\n\t\t\tthis.prev.on('click', this._onPrev);\r\n\t\t}\r\n\r\n\t\tif(dom.next) {\r\n\t\t\tthis.next = this.next || new Button();\r\n\t\t\tthis.next.setup(dom.next);\r\n\t\t\tthis.next.on('click', this._onNext);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tdispose() {\r\n\t\tif(this.pager) {\r\n\t\t\tthis.pager.off('index', this._on.bubble);\r\n\t\t\tthis.pager.dispose();\r\n\t\t}\r\n\r\n\t\tif(this.prev) {\r\n\t\t\tthis.prev.off('click', this._offPrev);\r\n\t\t\tthis.prev.dispose();\r\n\t\t}\r\n\t\t\r\n\t\tif(this.next) {\r\n\t\t\tthis.next.off('click', this._onNext);\r\n\t\t\tthis.next.dispose();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nUI.EVENT = {\r\n    PREV:\"ui_prev\",\r\n    NEXT:\"ui_next\"\r\n}","import {Material} from '../components/graphics/Material'\r\nimport {Model} from '../components/graphics/nodes/Node'\r\nimport {VarFormat} from '../components/graphics/assets/Buffer'\r\nimport {ShaderVar, ShaderVarFormat} from '../components/graphics/assets/Program'\r\n\r\n\r\nexport class XMaterial extends Material {\r\n    constructor(option) {\r\n        super(option);\r\n\r\n        this.program.addAttribute(new ShaderVar(\"position\", VarFormat.Float, ShaderVarFormat.Vector2));\r\n    }\r\n}\r\n\r\n\r\nexport class XModel extends Model {\r\n    constructor() {\r\n        super();\r\n\r\n        const vertices = [\r\n            -1.0, -1.0, \r\n             1.0, -1.0, \r\n             1.0,  1.0, \r\n            -1.0,  1.0, \r\n        ];\r\n\r\n        this.mesh.vertexBuffer.allocate(vertices.length);\r\n        this.mesh.vertexBuffer.put(vertices);\r\n\r\n        const indices = [0, 1, 2, 0, 2, 3];\r\n        this.mesh.indexBuffer.allocate(indices.length);\r\n        this.mesh.indexBuffer.put(indices);\r\n    }\r\n\r\n    set material(material) {\r\n        this.mesh.material = material;\r\n    }\r\n}","export class Color {\r\n    constructor() {\r\n        this.r = 0;\r\n        this.g = 0;\r\n        this.b = 0;\r\n        this.a = 1;\r\n    }\r\n\r\n    set(r, g, b, a) {\r\n        this.r = r;\r\n        this.g = g;\r\n        this.b = b;\r\n        this.a = a;\r\n    }\r\n}","export class Matrix3 {\r\n    constructor() {\r\n        this.identity();\r\n    }\r\n\r\n    identity() {\r\n        this.data = [1,0,0, 0,1,0, 0,0,1];\r\n    }\r\n\r\n    copy(dst) {\r\n        for(let i=0; i<this.data.length; i++) {\r\n            dst.data[i] = this.data.length;\r\n        }\r\n    }\r\n\r\n    translate() {\r\n\r\n    }\r\n\r\n    rotate() {\r\n\r\n    }\r\n\r\n    update(x, y, r, sx, sy) {\r\n        const s = Math.sin(r);\r\n        const c = Math.cos(r);\r\n\r\n        let data = this.data;\r\n        data[0] = c * sx;\r\n        data[1] = s * sx;\r\n        \r\n        data[3] = -s * sy;\r\n        data[4] = c * sy;\r\n\r\n        data[6] = x;\r\n        data[7] = y;\r\n    }\r\n}\r\n\r\n\r\nexport class Matrix4 {\r\n    constructor() {\r\n        this.identity();\r\n    }\r\n\r\n    identity() {\r\n        this.data = [1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1];\r\n    }\r\n\r\n    copy(dst) {\r\n        for(let i=0; i<this.data.length; i++) {\r\n            dst.data[i] = this.data.length;\r\n        }\r\n    }\r\n\r\n    perspective(fov, aspect, near, far) {\r\n        const n2 = near * 2;\r\n        fov = fov * Math.PI / 180;\r\n\r\n        const nf = 1 / (near - far);\r\n\r\n        const T= Math.tan(fov / 2) * near;\r\n        const B = -T;\r\n        const L = aspect * B;\r\n        const R = -L;\r\n\r\n        let data = this.data;\r\n\r\n        data[0] = n2 / (R - L);\r\n        data[5] = n2 / (T - B);\r\n        data[10] = (far + near) * nf;\r\n        data[11] = -1;\r\n        data[14] = n2 * far * nf;\r\n        data[15] = 0;\r\n    }\r\n\r\n    update(x, y, z, rx, ry, rz, sx, sy, sz) {\r\n        const sinX = Math.sin(rx);\r\n        const cosX = Math.cos(rx);\r\n        const sinY = Math.sin(ry);\r\n        const cosY = Math.cos(ry);\r\n        const sinZ = Math.sin(rz);\r\n        const cosZ = Math.cos(rz);\r\n\r\n        const sinYsinX = sinY * sinX;\r\n        const sinYcosX = sinY * cosX;\r\n\r\n        let data = this.data;\r\n\t\r\n        data[0] = cosZ*cosY * sx;\r\n        data[1] = sinZ*cosY * sx;\r\n        data[2] = -sinY * sx;\r\n        \r\n        data[4] = (cosZ*sinYsinX-sinZ*cosX) * sy;\r\n        data[5] = (sinZ*sinYsinX+cosZ*cosX) * sy;\r\n        data[6] = cosY*sinX * sy;\r\n        \r\n        data[8] = (cosZ*sinYcosX+sinZ*sinX) * sz;\r\n        data[9] = (sinZ*sinYcosX-cosZ*sinX) * sz;\r\n        data[10] = cosY*cosX * sz;\r\n    \r\n        data[12] = x;\r\n        data[13] = y;\r\n        data[14] = z;\r\n    }\r\n}","export class Vec2 {\r\n\tconstructor(x=0,y=0) {\r\n\t\tthis.set(x, y);\r\n\t}\r\n\r\n\tset(x, y) {\r\n\t\tthis.data = [x,y];\r\n\t}\r\n\r\n\tget x() { return this.data[0]; }\r\n\tget y() { return this.data[1]; }\r\n\r\n\tset x(v) { this.data[0] = v; }\r\n\tset y(v) { this.data[1] = v; }\r\n}\r\n\r\nexport class Vec3 {\r\n\tconstructor(x=0,y=0,z=0) {\r\n\t\tthis.set(x, y, z);\r\n\t}\r\n\r\n\tset(x, y, z) {\r\n\t\tthis.data = [x,y,z];\r\n\t}\r\n\r\n\tget x() { return this.data[0]; }\r\n\tget y() { return this.data[1]; }\r\n\tget z() { return this.data[2]; }\r\n\r\n\tset x(v) { this.data[0] = v; }\r\n\tset y(v) { this.data[1] = v; }\r\n\tset z(v) { this.data[2] = v; }\r\n}\r\n\r\nexport class Vec4 {\r\n\tconstructor(x=0,y=0,z=0,w=0) {\r\n\t\tthis.set(x, y, z, w);\r\n\t}\r\n\r\n\tset(x, y, z, w) {\r\n\t\tthis.data = [x,y,z,w];\r\n\t}\r\n\t\r\n\r\n\tset width(v) {\r\n\t\tthis.data[2] = v;\r\n\t}\r\n\r\n\tget width() {\r\n\t\treturn this.data[2];\r\n\t}\r\n\r\n\tset height(v) {\r\n\t\tthis.data[3] = v;\r\n\t}\r\n\r\n\tget height() {\r\n\t\treturn this.data[3];\r\n\t}\r\n\r\n\tget x() { return this.data[0]; }\r\n\tget y() { return this.data[1]; }\r\n\tget z() { return this.data[2]; }\r\n\tget w() { return this.data[3]; }\r\n\r\n\tset x(v) { this.data[0] = v; }\r\n\tset y(v) { this.data[1] = v; }\r\n\tset z(v) { this.data[2] = v; }\r\n\tset w(v) { this.data[3] = v; }\r\n\r\n\tequals(v) {\r\n\t\treturn this.x===v.x&&this.y==v.y&&this.z==v.z&&this.w==v.w;\r\n\t}\r\n}","import { Data } from './components/Data'\r\nimport { SlideController } from './SlideController'\r\nimport { EventDispatcher } from './core/EventDispatcher'\r\nimport { Utils } from './components/Utils'\r\n\r\n\r\nexport default class XSlider extends EventDispatcher {\r\n\tconstructor(...args) {\r\n\t\tsuper();\r\n\r\n\t\tthis.data = new Data();\r\n\t\tthis.controller = new SlideController();\r\n\r\n\t\tUtils.delegate(this, {\r\n\t\t\tprev: this.controller.prev,\r\n\t\t\tnext: this.controller.next,\r\n\t\t\tautoplay: {\r\n\t\t\t\tstart: this.controller.autoplay.start,\r\n\t\t\t\tstop: this.controller.autoplay.stop\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.setup(...args);\r\n\t}\r\n\r\n\tsetup(...args) {\r\n\t\t// console.log('args: ', args);\r\n\r\n\t\tthis.dispose();\r\n\r\n\t\tthis.data.setup(...args);\r\n\r\n\t\tthis.controller.setup(this.renderer, this.data);\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis.controller.dispose();\r\n\t\tthis.data.dispose();\r\n\t}\r\n}\r\n","import {EventDispatcher} from '../core/EventDispatcher'\r\n\r\nexport class BaseRenderer extends EventDispatcher {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\t\r\n\tsetup(data, container) {\r\n\t\tthis.data = data;\r\n\t\tthis.container = container;\r\n\t}\r\n\r\n\tdispose() {}\r\n\r\n\trender(indexer) {}\r\n\r\n\tresize(w, h) {\r\n\t\tthis.width = w;\r\n\t\tthis.height = h;\r\n\t}\r\n}\r\n\r\n\r\nexport class GLRenderer extends BaseRenderer {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.canvas = document.createElement('canvas');\r\n\r\n\t\tthis._defineHandlers();\r\n\t}\r\n\r\n\t_defineHandlers() {\r\n\t}\r\n\t\r\n\tsetup(data, container) {\r\n\t\tsuper.setup(data, container);\r\n\r\n\t\tdata.dom.container.insertBefore(this.canvas, data.dom.view);\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tsuper.dispose();\r\n\r\n\t\tthis.container.off('updateTexture', this._onUpdateTexture);\r\n\r\n\t\tthis.data.dom.container.removeChild(this.canvas);\r\n\t}\r\n\r\n\trender(indexer) {\r\n\t\tsuper.render(indexer);\r\n\r\n\t\tthis.container.uniforms.progress.value = indexer.progress;\r\n\t\tif(this.container.uniforms.time) {\r\n\t\t\tthis.container.uniforms.time.value = this.data.time;\r\n\t\t}\r\n\t}\r\n\r\n\tresize(w, h) {\r\n\t\tsuper.resize(w, h);\r\n\t}\r\n}\r\n","import {BaseRenderer} from './BaseRenderer'\r\nimport {Utils} from '../components/Utils'\r\nimport {stage} from '../core/Stage'\r\n\r\nexport class DefaultRenderer extends BaseRenderer {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis._defineHandlers();\r\n\t}\r\n\r\n\t_defineHandlers() {\r\n\r\n\t\tthis.dx = 0;\r\n\t\tthis._onTick = (e) => {\r\n\t\t\tconsole.log('e: ', e);\r\n\r\n\t\t\tthis.dx = 30 * Math.sin(e.time/1000);\r\n\r\n\t\t\tconst slide0 = this.data.list[0];\r\n\t\t\tif(slide0) {\r\n\t\t\t\tslide0.layer.ui.style.webkitTransform = \"translate(\"+this.dx+\"px, 0)\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetup(data, container) {\r\n\t\tsuper.setup(data, container);\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tsuper.dispose();\r\n\t}\r\n\r\n\trender(indexer) {\r\n\t\tsuper.render(indexer);\r\n\r\n\t\tconst slide0 = this.data.list[indexer.i0]\r\n\t\t, slide1 = this.data.list[indexer.i1];\r\n\r\n\t\tlet opacity = 1.0 - Utils.clamp(indexer.progress,0,0.5) / 0.5;\r\n\t\tlet dx = -indexer.progress * this.width;\r\n\t\tthis.updateSlide(slide0, opacity, dx);\r\n\r\n\t\tif(slide0 != slide1) {\r\n\t\t\topacity = Utils.clamp(indexer.progress-0.5,0,0.5) / 0.5;\r\n\t\t\tdx = (1-indexer.progress) * this.width;\r\n\t\t\tthis.updateSlide(slide1, opacity, dx);\r\n\t\t}\r\n\r\n\t\t// stage.on(\"tick\", this._onTick);\r\n\t\t\r\n\t}\r\n\r\n\tresize(w, h) {\r\n\t\tsuper.resize(w, h);\r\n\t}\r\n\r\n\tupdateSlide(slide, opacity, dx) {\r\n\r\n\t\tif(!slide || !slide.layer.ui)  return;\r\n\r\n\t\tslide.layer.ui.style.webkitTransform = \"translate(\"+dx+\"px, 0) scale(1)\";\r\n\t\t// slide.layer.ui.style.opacity = opacity;\r\n\r\n\t}\r\n}","import {GLRenderer} from './BaseRenderer'\r\n\r\nimport {GLGraphics} from '../components/graphics/GLGraphics'\r\nimport {Scene3D} from '../components/graphics/nodes/Scene'\r\nimport {XModel, XMaterial} from '../display/XModel'\r\nimport {Texture} from '../components/graphics/assets/Texture'\r\nimport {Utils} from '../components/Utils'\r\nimport {Vec2} from '../geom/Vec'\r\n\r\nexport class XRenderer extends GLRenderer {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.scene = new Scene3D();\r\n\t\t// this.scene.context.color.b = 1;\r\n\t\tthis.model = new XModel();\r\n\t\tthis.mesh = this.model.mesh;\r\n\r\n\t\tthis.scene.addChild(this.model);\r\n\r\n\t\tthis._uniform0 = {\r\n\t\t\ttexture0: { value: new Texture() },\r\n\t\t\ttexture1: { value: new Texture() },\r\n\t\t\tprogress:{ value: 0 },\r\n\t\t\tresolution: { value: new Vec2(0.0, 0.0) },\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetup(data, container) {\r\n\t\tsuper.setup(data, container);\r\n\r\n\t\tGLGraphics.setup(this.canvas);\r\n\r\n\t\tconst transition = data.option.transition;\r\n\r\n\t\tthis.mesh.material = new XMaterial({\r\n            vertexShader:transition.vertexShader, \r\n            fragmentShader:transition.fragmentShader,\r\n            uniforms: Utils.extend(transition.uniforms, this._uniform0)\r\n\t\t});\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tsuper.dispose();\r\n\r\n\t\tGLGraphics.deleteProgram(this.mesh.material.program);\r\n\t\tthis.mesh.material = undefined;\r\n\t}\r\n\r\n\trender(indexer) {\r\n\t\tsuper.render(indexer);\r\n\t\t\r\n\t\tGLGraphics.clear(this.scene.context);\r\n\t\tGLGraphics.renderModel(this.model);\r\n\t}\r\n\r\n\tresize(w, h) {\r\n\t\tsuper.resize(w, h);\r\n\r\n\t\tthis.canvas.setAttribute(\"width\", w);\r\n\t\tthis.canvas.setAttribute(\"height\", h);\r\n\r\n\t\tthis.scene.camera.setViewport(0,0,w,h);\r\n\t}\r\n}","import {Utils} from '../components/Utils'\r\nimport {Vec2, Vec3, Vec4} from '../geom/Vec'\r\n\r\n\r\nexport const BaseTransition = {\r\n\r\n\tvertexShader: `\r\nattribute vec2 position;\r\n\r\nvoid main(void) {\r\n\tgl_Position = vec4(position, 0.0, 1.0);\r\n}\r\n`,\r\n\r\n\tfragmentShader : `\r\nprecision highp float;\r\n\r\nuniform sampler2D texture0;\r\nuniform sampler2D texture1;\r\nuniform float progress;\r\nuniform vec2 resolution;\r\nuniform vec2 gradient;\r\n\r\nvoid main(void) {\r\n\tvec2 uv = gl_FragCoord.xy /resolution.xy;\r\n\tvec4 color0 = texture2D(texture0, uv);\r\n\tvec4 color1 = texture2D(texture1, uv);\r\n\tfloat v = smoothstep(0.0, 1.0, progress * (1.0+gradient.x+gradient.y) - ((1.0-uv.x)*gradient.x+uv.y*gradient.y));\r\n\tgl_FragColor = mix(color0, color1, v);\r\n}\r\n`,\r\n\r\n\tuniforms: {\r\n\t\tgradient: { value: new Vec2(1.0, 1.0) },\r\n\t},\r\n\r\n\textend(o) {\r\n\t\treturn Utils.extend(this, o);\r\n\t}\r\n}\r\n\r\n","import {BaseTransition} from './BaseTransition'\r\nimport {Vec2, Vec3, Vec4} from '../geom/Vec'\r\n\r\n/**\r\n * It's based on {@link https://gl-transitions.com/editor/crosswarp crosswarp by Eke Pter}.\r\n */\r\nexport const CrossWarpTransition = BaseTransition.extend({\r\n\r\nfragmentShader : `\r\nprecision highp float;\r\n\r\nuniform sampler2D texture0;\r\nuniform sampler2D texture1;\r\nuniform float progress;\r\nuniform vec2 resolution;\r\nuniform vec2 gradient;\r\n\r\nvoid main(void) {\r\n\tvec2 p = gl_FragCoord.xy /resolution.xy;\r\n\r\n\tfloat v = mix(0.0, 1.0, progress * (1.0+gradient.x+gradient.y) - ((1.0-p.x)*gradient.x+p.y*gradient.y));\r\n\tv = clamp(v, 0.0, 1.0);\r\n\r\n\tvec2 p0 = p;\r\n\tvec2 p1 = p;\r\n\r\n\tp0 -= 0.5;\r\n\tp0 *= (1.0 - v);\r\n\tp0 += 0.5;\r\n\r\n\tp1 -= 0.5;\r\n\tp1 *= v;\r\n\tp1 += 0.5;\r\n\r\n\tvec4 color0 = texture2D(texture0, p0);\r\n\tvec4 color1 = texture2D(texture1, p1);\r\n\r\n\tgl_FragColor = mix(color0, color1, v);\r\n}\r\n`,\r\n\r\n\tuniforms: {\r\n\t\tgradient: { value: new Vec2(0.5, 0.5) },\r\n\t}\r\n});","import {BaseTransition} from './BaseTransition'\r\nimport {Vec2, Vec3, Vec4} from '../geom/Vec'\r\n\r\n/**\r\n * It's based on {@link https://gl-transitions.com/editor/CrossZoom CrossZoom by rectalogic}.\r\n */\r\nexport const CrossZoomTransition = BaseTransition.extend({\r\n\r\nfragmentShader : `\r\nprecision highp float;\r\n\r\n#define PI 3.141592653589793\r\n\r\nuniform sampler2D texture0;\r\nuniform sampler2D texture1;\r\nuniform float progress;\r\nuniform vec2 resolution;\r\n// uniform vec2 fade;\r\nuniform float strength;\r\n\r\n\r\nfloat Linear_ease(in float begin, in float change, in float duration, in float time) {\r\n    return change * time / duration + begin;\r\n}\r\n\r\nfloat Exponential_easeInOut(in float begin, in float change, in float duration, in float time) {\r\n    if (time == 0.0)\r\n        return begin;\r\n    else if (time == duration)\r\n        return begin + change;\r\n    time = time / (duration / 2.0);\r\n    if (time < 1.0)\r\n        return change / 2.0 * pow(2.0, 10.0 * (time - 1.0)) + begin;\r\n    return change / 2.0 * (-pow(2.0, -10.0 * (time - 1.0)) + 2.0) + begin;\r\n}\r\n\r\nfloat Sinusoidal_easeInOut(in float begin, in float change, in float duration, in float time) {\r\n    return -change / 2.0 * (cos(PI * time / duration) - 1.0) + begin;\r\n}\r\n\r\n/* random number between 0 and 1 */\r\nfloat hash(in vec3 scale, in float seed) {\r\n    /* use the fragment position for randomness */\r\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\r\n}\r\n\r\nvec3 crossFade(in vec2 uv, in float dissolve) {\r\n    return mix(texture2D(texture0, uv).rgb, texture2D(texture1, uv).rgb, dissolve);\r\n}\r\n\r\nvoid main(void) {\r\n\tvec2 p = gl_FragCoord.xy /resolution.xy;\r\n\r\n\tvec2 center = vec2(Linear_ease(0.25, 0.5, 1.0, progress), 0.5);\r\n\tfloat dissolve = Exponential_easeInOut(0.0, 1.0, 1.0, progress);\r\n\tfloat strength = Sinusoidal_easeInOut(0.0, strength, 0.5, progress);\r\n\tvec3 color = vec3(0.0);\r\n\tfloat total = 0.0;\r\n\tvec2 toCenter = center - p;\r\n\tfloat offset = hash(vec3(12.9898, 78.233, 151.7182), 0.0);\r\n\r\n\tfor (float t = 0.0; t <= 40.0; t++) {\r\n\t  float percent = (t + offset) / 40.0;\r\n\t  float weight = 4.0 * (percent - percent * percent);\r\n\t  color += crossFade(p + toCenter * percent * strength, dissolve) * weight;\r\n\t  total += weight;\r\n\t  gl_FragColor = vec4(color / total, 1.0);\r\n\t}\r\n}\r\n`,\r\n\r\n\tuniforms: {\r\n\t\tstrength:{ value: 1.0 },\r\n\t}\r\n\r\n});","import {BaseTransition} from './BaseTransition'\r\nimport {Vec2, Vec3, Vec4} from '../geom/Vec'\r\n\r\n\r\n/**\r\n * It's based on {@link https://gl-transitions.com/editor/cube cube by gre}.\r\n */\r\nexport const CubeTransition = BaseTransition.extend({\r\n\r\nfragmentShader : `\r\nprecision highp float;\r\n\r\nuniform sampler2D texture0;\r\nuniform sampler2D texture1;\r\nuniform float progress;\r\nuniform vec2 resolution;\r\nuniform vec4 bgColor;\r\n\r\nuniform float floating;\r\nuniform float unzoom;\r\nuniform float perspective;\r\nuniform float reflection;\r\n\r\n\r\nvec2 project (vec2 p) {\r\n  return p * vec2(1.0, -1.2) + vec2(0.0, -floating/100.0);\r\n}\r\n\r\nbool inBounds (vec2 p) {\r\n  return all(lessThan(vec2(0.0), p)) && all(lessThan(p, vec2(1.0)));\r\n}\r\n\r\n/**\r\n * persp 0-1 1:\r\n * center 1.0:from 0.0:to\r\n */\r\nvec2 xskew (vec2 p, float persp, float center) {\r\n  float x = mix(p.x, 1.0-p.x, center);\r\n  float d = distance(center, 0.5);\r\n  return (\r\n    (vec2( x, (p.y - 0.5 * (1.0 - persp) * x) / (1.0 + (persp - 1.0) * x)) - vec2(0.5 - d, 0.0))\r\n    * vec2(0.5 / d * -sign(center-0.5), 1.0)\r\n    + vec2(center, 0.0)\r\n  );\r\n}\r\n\r\nvoid main(void) {\r\n\tvec2 uv = gl_FragCoord.xy /resolution.xy;\r\n\r\n\tfloat uz = unzoom * 2.0 * (0.5 - distance(0.5, progress));\r\n\tvec2 p = -uz * 0.5 + (1.0 + uz) * uv;\r\n\r\n\tvec2 fromP, toP;\r\n\r\n\tfromP = xskew(\r\n\t\tp / vec2(1.0-progress, 1.0),\r\n\t\tmix(1.0-progress, 1.0, perspective),\r\n\t\t1.0\r\n\t);\r\n\r\n\ttoP = xskew(\r\n\t\t(p - vec2(1.0-progress, 0.0)) / vec2(progress, 1.0),\r\n\t\t1.0 - mix(1.0-progress, 0.0, perspective),\r\n\t\t0.0\r\n\t);\r\n\r\n\tif (inBounds(fromP)) {\r\n\t\tgl_FragColor = texture2D(texture0, fromP);\r\n\t}\r\n\telse if (inBounds(toP)) {\r\n\t\tgl_FragColor = texture2D(texture1, toP);\r\n\t}\r\n\telse {\r\n\t\tfromP = project(fromP);\r\n\t\ttoP = project(toP);\r\n\r\n\t\tvec4 color0 = texture2D(texture0, fromP);\r\n\t\tvec4 color1 = texture2D(texture1, toP);\r\n\r\n\t\tgl_FragColor = bgColor\r\n\t\t\t+ float(inBounds(fromP)) * mix(bgColor, color0, reflection * mix(1.0, 0.0, fromP.y))\r\n\t\t\t+ float(inBounds(toP)) * mix(bgColor, color1, reflection * mix(1.0, 0.0, toP.y));\r\n\t}\r\n\r\n\r\n\r\n\r\n}\r\n`,\r\n\r\n\tuniforms: {\r\n\t\tbgColor: { value: new Vec4(0.1, 0.1, 0.1, 1.0) },\r\n\t\tunzoom:{ value: 0.3 },\r\n\t\tfloating:{ value: 3.0 },\r\n\t\tperspective:{ value: 0.7 },\r\n\t\treflection:{ value: 0.4 },\r\n\t}\r\n});","import {BaseTransition} from './BaseTransition'\r\nimport {Vec2, Vec3, Vec4} from '../geom/Vec'\r\n\r\n/**\r\n * It's based on {@link https://gl-transitions.com/editor/morph morph by paniq}.\r\n */\r\nexport const MorphTransition = BaseTransition.extend({\r\n\r\nfragmentShader : `\r\nprecision highp float;\r\n\r\nuniform sampler2D texture0;\r\nuniform sampler2D texture1;\r\nuniform float progress;\r\nuniform vec2 resolution;\r\n// uniform vec2 fade;\r\nuniform float strength;\r\n\r\nvoid main(void) {\r\n\tvec2 p = gl_FragCoord.xy /resolution.xy;\r\n\r\n\tvec4 c0 = texture2D(texture0, p);\r\n\tvec4 c1 = texture2D(texture1, p);\r\n\r\n\tvec2 oa = (((c0.rg + c0.b) * 0.5) * 2.0 - 1.0);\r\n\tvec2 ob = (((c1.rg + c1.b) * 0.5) * 2.0 - 1.0);\r\n\tvec2 oc = mix(oa,ob,0.5)*strength;\r\n\r\n\t// float v = smoothstep(0.0, 1.0, progress * (1.0+fade.x+fade.y) - ((1.0-p.x)*fade.x+p.y*fade.y));\r\n\tfloat v = progress;\r\n\r\n\tc0 = texture2D(texture0, p + oc * v);\r\n\tc1 = texture2D(texture1, p - oc * (1.0 - v));\r\n\r\n\tgl_FragColor = mix(c0, c1, v);\r\n}\r\n`,\r\n\r\n\tuniforms: {\r\n\t\tstrength: { value: 1.0 },\r\n\t}\r\n});","import {BaseTransition} from './BaseTransition'\r\nimport {Vec2, Vec3, Vec4} from '../geom/Vec'\r\n\r\n/**\r\n * It's based on {@link https://logik-matchbook.org/shader/crok_transitions crok_transitions by Gatan Renaudeau}.\r\n */\r\nexport const NoiseTransition = BaseTransition.extend({\r\n\r\n    fragmentShader : `\r\nprecision highp float;\r\n\r\nuniform sampler2D texture0;\r\nuniform sampler2D texture1;\r\nuniform float progress;\r\nuniform vec2 resolution;\r\n// uniform vec2 fade;\r\n\r\nuniform float dark_low, dark_high, light_low, light_high;\r\nuniform float brightness, contrast, saturation;\r\nuniform vec3 light_tint, dark_tint;\r\n\r\nuniform float rgbOffsetOpt;\r\nuniform float horzFuzzOpt;\r\nuniform float zoom;\r\nuniform float time;\r\n\r\nuniform float t_amount, exposure;\r\n\r\nconst vec3 lumc = vec3(0.2125, 0.7154, 0.0721);\r\nconst vec3 avg_lum = vec3(0.5, 0.5, 0.5);\r\n\r\n\r\nvec3 tint(vec3 col)\r\n{\r\n\tfloat bri = (col.x + col.y + col.z)/3.0;\r\n\r\n\tfloat v = smoothstep(dark_low, dark_high, bri);\r\n\tcol = mix(dark_tint * bri, col, v);\r\n\r\n\tv = smoothstep(light_low, light_high, bri);\r\n\tcol = mix(col, min(light_tint * col, 1.0), v);\r\n\r\n\tvec3 intensity = vec3(dot(col.rgb, lumc));\r\n\tvec3 sat_color = mix(intensity, col.rgb, saturation);\r\n\tvec3 con_color = mix(avg_lum, sat_color, contrast);\r\n\t\r\n\treturn (con_color - 1.0 + brightness) * exposure;\r\n}\r\n\r\n// Noise generation functions borrowed from:\r\n// https://github.com/ashima/webgl-noise/blob/master/src/noise2D.glsl\r\n\r\nvec3 mod289(vec3 x) {\r\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\r\n}\r\n\r\nvec2 mod289(vec2 x) {\r\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\r\n}\r\n\r\nvec3 permute(vec3 x) {\r\n  return mod289(((x*34.0)+1.0)*x);\r\n}\r\n\r\nfloat snoise(vec2 v)\r\n  {\r\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\r\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\r\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\r\n                      0.024390243902439); // 1.0 / 41.0\r\n\t// First corner\r\n  vec2 i  = floor(v + dot(v, C.yy) );\r\n  vec2 x0 = v -   i + dot(i, C.xx);\r\n\r\n\t// Other corners\r\n  vec2 i1;\r\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\r\n  //i1.y = 1.0 - i1.x;\r\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\r\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\r\n  // x1 = x0 - i1 + 1.0 * C.xx ;\r\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\r\n  vec4 x12 = x0.xyxy + C.xxzz;\r\n  x12.xy -= i1;\r\n\r\n\t// Permutations\r\n  i = mod289(i); // Avoid truncation effects in permutation\r\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\r\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\r\n\r\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\r\n  m = m*m ;\r\n  m = m*m ;\r\n\r\n\t// Gradients: 41 points uniformly over a line, mapped onto a diamond.\r\n\t// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\r\n\r\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\r\n  vec3 h = abs(x) - 0.5;\r\n  vec3 ox = floor(x + 0.5);\r\n  vec3 a0 = x - ox;\r\n\r\n\t// Normalise gradients implicitly by scaling m\r\n\t// Approximation of: m *= inversesqrt( a0*a0 + h*h );\r\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\r\n\r\n\t// Compute final noise value at P\r\n  vec3 g;\r\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\r\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\r\n  return 130.0 * dot(m, g);\r\n}\r\n\r\nvoid main(void) {\r\n\r\n\tvec2 p =  gl_FragCoord.xy/resolution.xy;\r\n\tvec2 p0 = p;\r\n\tvec2 p1 = p;\r\n\r\n\tp0 -= 0.5;\r\n\tp1 -= 0.5;\r\n\tp0 *= 1.0 - progress * zoom;\r\n\tp1 *= 1.0 - (1.0 - progress) * zoom;\r\n\tp0 += 0.5;\r\n\tp1 += 0.5;\r\n\r\n\tfloat v = min(progress, 1.0 - progress) * 2.0;\t//0.0-1.0\r\n\r\n\tfloat fuzzOffset = snoise(vec2(time*15.0, p.y * 20.0)) * 0.0015;\r\n\tfloat largeFuzzOffset = snoise(vec2(time*1.0, p.y * 1.0)) * (0.003 + v * 0.01);\r\n\tfloat f_xoff = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt * progress;\r\n    float b_xoff = (fuzzOffset + largeFuzzOffset) * horzFuzzOpt * (1.0 - progress);\r\n    \r\n    // float rgbOffset = rgbOffsetOpt * fuzzOffset * 300.0;\r\n    // float rgbOffset = rgbOffsetOpt;\r\n    float rgbOffset = snoise(vec2(time*15.0, 1.0)) * rgbOffsetOpt;\r\n\r\n\tvec3 f_col = vec3(\r\n\t\ttexture2D(texture0,\tvec2(p0.x + f_xoff -0.01 * rgbOffset * progress, p0.y)).r,\r\n\t\ttexture2D(texture0, vec2(p0.x + f_xoff,\t  p0.y)).g,\r\n\t\ttexture2D(texture0, vec2(p0.x + f_xoff +0.01 * rgbOffset * progress, p0.y)).b\r\n\t);\r\n\r\n\tvec3 b_col = vec3(\r\n\t\ttexture2D(texture1, vec2(p1.x + b_xoff -0.01 * rgbOffset * (1.0 - progress), p1.y)).r,\r\n\t\ttexture2D(texture1, vec2(p1.x + b_xoff,\t  p1.y)).g,\r\n\t\ttexture2D(texture1, vec2(p1.x + b_xoff +0.01 * rgbOffset * (1.0 - progress), p1.y)).b\r\n\t);\r\n\r\n\tvec3 ff_col = f_col;\r\n\tff_col = tint(ff_col);\r\n\tff_col = mix(f_col, ff_col, t_amount * progress);\r\n\r\n\tvec3 bb_col = b_col;\r\n\tbb_col = tint(bb_col);\r\n\tbb_col = mix(b_col, bb_col, t_amount * (1.0 - progress));\r\n\r\n\tgl_FragColor = vec4(mix(ff_col, bb_col, progress), 1.0);\r\n}\r\n`,\r\n\r\n\tuniforms: {\r\n\t\ttime:{ value: 0 },\r\n\t\t\r\n\t\tzoom:{ value: 0.3 },\r\n\r\n\t\tdark_low:{ value: 100 },\r\n\t\tdark_high:{ value: 200 },\r\n\t\tdark_low:{ value: 200 },\r\n\t\tdark_high:{ value: 255 },\r\n\t\tcontrast:{ value: 1 },\r\n\t\tbrightness:{ value: 1 },\r\n\t\tsaturation:{ value: 100 },\r\n\t\tlight_tint: { value: new Vec3(0.5, 0.5, 0.5) },\r\n\t\tdark_tint: { value: new Vec3(0.2, 0.2, 0.2) },\r\n\t\tt_amount:{ value: 0.5 },\r\n\t\texposure:{ value: 30 },\r\n\t\thorzFuzzOpt:{ value: 10 },\r\n\t\trgbOffsetOpt:{ value: 20 },\r\n\t}\r\n\r\n});","import {BaseTransition} from './BaseTransition'\r\nimport {Vec2, Vec3, Vec4} from '../geom/Vec'\r\n\r\n\r\n\r\nexport const PixelateTransition = BaseTransition.extend({\r\n\r\nfragmentShader : `\r\nprecision highp float;\r\n\r\n\r\n#define N 10.0\r\n\r\nuniform sampler2D texture0;\r\nuniform sampler2D texture1;\r\nuniform float progress;\r\nuniform vec2 resolution;\r\n\r\nvoid main(void) {\r\n\tvec2 p = gl_FragCoord.xy /resolution;\t//0.0-1.0\r\n\tfloat aspect = resolution.x / resolution.y;\r\n\tfloat v = min(progress, 1.0 - progress) * 2.0;\t//0.0-1.0\r\n\tv = floor(v * 30.0) / 30.0;\r\n\r\n\tif(v > 0.0) {\r\n\t\tvec2 steps = vec2(aspect, 1.0) * N / v;\r\n\t\r\n\t\tp -= 0.5;\r\n\t\r\n\t\tsteps = min(steps, resolution.xy);\r\n\t\tp = (floor(p * steps) + 0.5) / steps;\r\n\t\r\n\t\tp += 0.5;\r\n\t}\r\n\r\n\tvec4 c0 = texture2D(texture0, p);\r\n\tvec4 c1 = texture2D(texture1, p);\r\n\r\n\tgl_FragColor = mix(c0, c1, progress);\r\n}\r\n`,\r\n\r\n\tuniforms: {\r\n\t}\r\n});\r\n\r\n\r\n","import {BaseTransition} from './BaseTransition'\r\nimport {Vec2, Vec3, Vec4} from '../geom/Vec'\r\n\r\n\r\n\r\nexport const PixelateWipeTransition = BaseTransition.extend({\r\n\r\nfragmentShader : `\r\n\r\nprecision highp float;\r\n\r\n#define N 10.0\r\n\r\nuniform sampler2D texture0;\r\nuniform sampler2D texture1;\r\nuniform float progress;\r\nuniform vec2 resolution;\r\nuniform vec2 gradient;\r\n\r\nvoid main(void) {\r\n\tvec2 p = gl_FragCoord.xy /resolution;\r\n\tfloat aspect = resolution.x / resolution.y;\r\n\r\n\tfloat v = mix(0.0, 1.0, progress * (1.0+gradient.x+gradient.y) - ((1.0-p.x)*gradient.x+p.y*gradient.y));\r\n\tv = clamp(v, 0.0, 1.0);\r\n\tv = floor(v * 16.0) / 16.0;\r\n\r\n\tif(v!=0.0) {\r\n\t\tp -= 0.5;\r\n\t\r\n\t\tfloat pv = min(v, 1.0 - v) * 2.0;\t//0.0-1.0\r\n\t\tvec2 steps = vec2(aspect, 1.0) * N / pv;\r\n\t\tsteps = min(steps, resolution.xy);\r\n\t\tp = (floor(p * steps) + 0.5) / steps;\r\n\t\r\n\t\tp += 0.5;\r\n\t}\r\n\r\n\tvec4 c0 = texture2D(texture0, p);\r\n\tvec4 c1 = texture2D(texture1, p);\r\n\r\n\t// v = step(0.5, v);\r\n\r\n\tgl_FragColor = mix(c0, c1, v);\r\n}\r\n`,\r\n\r\n\tuniforms: {\r\n\t\tgradient: { value: new Vec2(0.5, 0) },\r\n\t}\r\n});\r\n\r\n\r\n","import './xslider.scss';\r\n// const XSlider = require('./modules/main.js').default;\r\n// const XSlider = require('./modules/main.js')\r\nimport XSlider from './modules/main.js'\r\nimport { stage } from './modules/core/Stage.js'\r\nimport { BaseTransition } from './modules/transitions/BaseTransition'\r\nimport { CrossWarpTransition } from './modules/transitions/CrossWarpTransition'\r\nimport { CrossZoomTransition } from './modules/transitions/CrossZoomTransition'\r\nimport { CubeTransition } from './modules/transitions/CubeTransition'\r\nimport { MorphTransition } from './modules/transitions/MorphTransition'\r\nimport { NoiseTransition } from './modules/transitions/NoiseTransition'\r\nimport { PixelateTransition } from './modules/transitions/PixelateTransition'\r\nimport { PixelateWipeTransition } from './modules/transitions/PixelateWipeTransition'\r\nimport { Option } from './modules/components/Option'\r\nimport { Utils } from './modules/components/Utils'\r\nimport { Vec2, Vec3, Vec4 } from './modules/geom/Vec'\r\nimport { Matrix3, Matrix4 } from './modules/geom/Matrix'\r\n\r\n//exports\r\nXSlider.stage = stage;\r\n\r\nXSlider.BaseTransition = BaseTransition;\r\nXSlider.CrossWarpTransition = CrossWarpTransition;\r\nXSlider.CrossZoomTransition = CrossZoomTransition;\r\nXSlider.CubeTransition = CubeTransition;\r\nXSlider.MorphTransition = MorphTransition;\r\nXSlider.NoiseTransition = NoiseTransition;\r\nXSlider.PixelateTransition = PixelateTransition;\r\nXSlider.PixelateWipeTransition = PixelateWipeTransition;\r\n\r\nXSlider.Vec2 = Vec2;\r\nXSlider.Vec3 = Vec3;\r\nXSlider.Vec4 = Vec4;\r\nXSlider.Matrix3 = Matrix3;\r\nXSlider.Matrix4 = Matrix4;\r\n\r\nXSlider.Utils = Utils;\r\nXSlider.Debug = Option.Debug;\r\n\r\nif (typeof window !== 'undefined') {\r\n  window.XSlider = XSlider;\r\n} else if (typeof global !== 'undefined') {\r\n  global.XSlider = XSlider;\r\n}\r\n\r\n// window.XSlider = XSlider;\r\n// export { XSlider }\r\n// export XSlider\r\nexport default XSlider;\r\n// exports { XSlider };\r\n// module.exports = XSlider","// removed by extract-text-webpack-plugin"],"sourceRoot":""}